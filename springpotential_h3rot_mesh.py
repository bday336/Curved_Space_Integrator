from asyncio import new_event_loop
from symint_bank import imph3sprot3,imph3sprot3_condense_econ, imph3sprot_mesh
from function_bank import hyper2poinh3,h3dist,boostxh3,rotxh3,rotyh3,rotzh3,hypercirch3,collisionh3,convertpos_hyp2roth3,convertpos_rot2hyph3,initial_con
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
from matplotlib import gridspec
from matplotlib import animation, rc
import numpy as np
import copy as cp
from numpy import zeros,array,arange,sqrt,sin,cos,tan,sinh,cosh,tanh,pi,arcsinh,arccosh,arctanh,arctan2,matmul,exp,identity,append,pi

# Here we take a mesh data structure as an initial condition for the positions
# and connections acting as the springs for the edges. The generic structure is
# given to be taken in the form of
# [ 
#   array of vertex position (x,y,z) , 
#   array of tuples of vertex indices forming egdes (1,2) ,
#   array of 3-tuple of vertex indices forming facets (1,2,3)
#  ]
# Needs to take care to scale it an appropriate size since the euclidean coordinates
# will be interpreted as coordinates in Poincare disk (probably not best choice, but
# that is what we will use for now). (Rotational parameterization for position and
# velocity values)

# The initial velocities of the vertices will be given through the killing field 
# initializer which describes a general loxodromic killing field along the x-axis.
# This will form the second array needed to initialize the problem. With the third 
# array containing the data concerning the mass of each vertex, and values for stiffness
# and rest length of the spring/edges between each vertex.

# Manually generate mesh data
mesh=[ # Dumbbell mesh
    [ # Vertex position 
        [.5,np.pi/2.,1.*np.pi/2.],      #particle 1
        [.5,np.pi/2.,3.*np.pi/2.]      #particle 2
    ]
    ,
    [ # Edge connection given by vertex indices
        [0,1]
    ]
    ,
    [ # Face given by the vertex indices (here for completeness)
        
    ]
]
# mesh=[ # Equilateral triangle mesh
#     [ # Vertex position 
#         [.5,np.pi/2.,0.*2.*np.pi/3.],      #particle 1
#         [.5,np.pi/2.,1.*2.*np.pi/3.],      #particle 2
#         [.5,np.pi/2.,2.*2.*np.pi/3.]       #particle 3
#     ]
#     # [ # Vertex position (Analytic check)
#     #     [arccosh(cosh(1)/cosh(.5)),np.pi/2.,0.],      #particle 1
#     #     [.5,np.pi/2.,1.*np.pi/2.],                    #particle 2
#     #     [.5,np.pi/2.,3.*np.pi/2.]                     #particle 3
#     # ]
#     ,
#     [ # Edge connection given by vertex indices
#         [0,1],
#         [0,2],
#         [1,2]
#     ]
#     ,
#     [ # Face given by the vertex indices (here for completeness)
#         [0,1,2]
#     ]
# ]

# mesh=[ # D20
#     [
#         [0.5, 3.04159, 1.5708], 
#         [0.5, 0.1, -1.5708], 
#         [0.5, 2.03195, 
#         3.09172], [0.5, 1.10965, -0.0498753], [0.5, 
#         2.09147, -0.584217], [0.5, 1.97414, 0.665288], [0.5, 
#         1.16745, -2.4763], [0.5, 1.05012, 2.55738], [0.5, 
#         2.12928, -1.90277], [0.5, 1.93912, 1.87157], [0.5, 
#         1.20247, -1.27002], [0.5, 1.01231, 1.23882]
#     ], 
#     [
#         [1, 11], [11, 
#         7], [7, 1], [7, 6], [6, 1], [6, 10], [10, 1], [10, 3], [3, 1], [3, 
#         11], [4, 8], [8, 0], [0, 4], [5, 4], [0, 5], [9, 5], [0, 9], [2, 
#         9], [0, 2], [8, 2], [11, 9], [9, 7], [7, 2], [2, 6], [6, 8], [8, 
#         10], [10, 4], [4, 3], [3, 5], [5, 11]
#    ], 
#    [
#        [1, 11, 7], [1, 7, 6], [1,
#         6, 10], [1, 10, 3], [1, 3, 11], [4, 8, 0], [5, 4, 0], [9, 5, 
#         0], [2, 9, 0], [8, 2, 0], [11, 9, 7], [7, 2, 6], [6, 8, 10], [10, 
#         4, 3], [3, 5, 11], [4, 10, 8], [5, 3, 4], [9, 11, 5], [2, 7, 
#         9], [8, 6, 2]
#    ]
# ]

# mesh=[ # Sphere shell
# [[0.5, 0.65887, -3.01165], [0.5, 1.10965, -0.0498753], [0.5, 
#    0.1, -1.5708], [0.5, 1.16745, -2.4763], [0.5, 1.05012, 
#    2.55738], [0.5, 3.04159, 1.5708], [0.5, 1.20247, -1.27002], [0.5, 
#    1.01231, 1.23882], [0.5, 0.748007, -1.85022], [0.5, 0.557986, 
#    1.93296], [0.5, 0.598277, 0.511537], [0.5, 
#    0.715048, -0.724155], [0.5, 2.48272, 0.129947], [0.5, 
#    2.58361, -1.20863], [0.5, 2.39359, 1.29138], [0.5, 2.42654, 
#    2.41744], [0.5, 2.54332, -2.63006], [0.5, 
#    1.44142, -0.641245], [0.5, 1.47727, -1.88059], [0.5, 1.324, 
#    0.610286], [0.5, 1.28709, 1.89249], [0.5, 1.38304, -3.12253], [0.5,
#     1.75855, 0.0190642], [0.5, 1.8545, -1.24911], [0.5, 1.66433, 
#    1.261], [0.5, 1.81759, -2.53131], [0.5, 1.70017, 2.50035], [0.5, 
#    2.09147, -0.584217], [0.5, 2.03195, 3.09172], [0.5, 1.97414, 
#    0.665288], [0.5, 2.12928, -1.90277], [0.5, 1.93912, 1.87157], [0.5,
#     1.32911, -1.58555], [0.5, 0.955779, -1.51338], [0.5, 
#    1.11259, -1.86826], [0.5, 1.12913, 1.58664], [0.5, 0.922447, 
#    1.90687], [0.5, 0.756169, 1.50243], [0.5, 2.01246, -1.55495], [0.5,
#     2.38542, -1.63916], [0.5, 2.21915, -1.23472], [0.5, 1.81249, 
#    1.55604], [0.5, 2.029, 1.27333], [0.5, 2.18581, 1.62822], [0.5, 
#    2.86264, -2.79772], [0.5, 2.90853, -1.12771], [0.5, 
#    2.68219, -1.94592], [0.5, 1.6708, -1.5708], [0.5, 
#    1.80329, -1.89079], [0.5, 2.71922, 1.32684], [0.5, 2.74852, 
#    2.3142], [0.5, 2.49225, 1.84282], [0.5, 1.61311, 1.88218], [0.5, 
#    1.4708, 1.5708], [0.5, 0.422376, -1.81476], [0.5, 
#    0.649338, -1.29877], [0.5, 0.393068, -0.827392], [0.5, 
#    1.52848, -1.25941], [0.5, 0.233058, 2.01388], [0.5, 0.278954, 
#    0.343876], [0.5, 0.459402, 1.19567], [0.5, 1.3383, 1.2508], [0.5, 
#    2.80095, 0.286989], [0.5, 2.6409, -0.482071], [0.5, 2.52448, 
#    0.745151], [0.5, 1.30969, -0.945712], [0.5, 
#    1.65165, -0.940094], [0.5, 1.14983, 0.902805], [0.5, 1.48994, 
#    0.940094], [0.5, 1.26013, -2.81045], [0.5, 
#    0.896282, -2.68898], [0.5, 1.02031, -3.07997], [0.5, 1.20135, 
#    2.87835], [0.5, 0.823136, 2.85019], [0.5, 
#    0.934657, -2.21169], [0.5, 0.617116, -2.39644], [0.5, 0.50069, 
#    2.65952], [0.5, 0.780803, 2.3231], [0.5, 1.99177, -2.23879], [0.5, 
#    2.18098, -2.56758], [0.5, 2.36864, -2.18976], [0.5, 1.8319, 
#    2.19588], [0.5, 2.20011, 2.09569], [0.5, 2.0637, 2.46735], [0.5, 
#    0.34064, -2.8546], [0.5, 2.31846, -0.291404], [0.5, 
#    2.36079, -0.818489], [0.5, 2.24531, 0.452616], [0.5, 2.20694, 
#    0.929901], [0.5, 1.07789, -0.67424], [0.5, 
#    0.941479, -1.04591], [0.5, 0.772957, 0.951837], [0.5, 0.960609, 
#    0.574014], [0.5, 2.25676, 2.80873], [0.5, 2.57999, 2.98144], [0.5, 
#    2.30639, -2.97635], [0.5, 0.835207, 0.165243], [0.5, 
#    0.561606, -0.16015], [0.5, 0.884833, -0.332861], [0.5, 
#    1.65165, -2.2015], [0.5, 1.48994, 2.2015], [0.5, 
#    1.94316, -2.84777], [0.5, 1.87861, 2.78052], [0.5, 
#    1.94024, -0.263247], [0.5, 2.12129, 0.0616223], [0.5, 1.88146, 
#    0.331144], [0.5, 1.60165, -0.31269], [0.5, 
#    1.76652, -0.614636], [0.5, 1.6491, 0.63706], [0.5, 1.53994, 
#    0.31269], [0.5, 1.43402, -0.0138102], [0.5, 
#    1.26299, -0.361071], [0.5, 1.19843, 0.293827], [0.5, 
#    1.31143, -2.16629], [0.5, 1.14798, 2.20745], [0.5, 
#    1.99361, -0.934143], [0.5, 1.83016, 0.975305], [0.5, 
#    1.60165, -2.8289], [0.5, 1.70757, 3.12778], [0.5, 1.53994, 
#    2.8289], [0.5, 1.49249, -2.50453], [0.5, 1.37507, 2.52696]], [[6, 
#    33], [33, 32], [32, 6], [33, 34], [34, 32], [34, 18], [18, 
#    32], [33, 8], [8, 34], [20, 36], [36, 35], [35, 20], [36, 37], [37,
#     35], [37, 7], [7, 35], [36, 9], [9, 37], [30, 39], [39, 38], [38, 
#    30], [39, 40], [40, 38], [40, 23], [23, 38], [39, 13], [13, 
#    40], [24, 42], [42, 41], [41, 24], [42, 43], [43, 41], [43, 
#    31], [31, 41], [42, 14], [14, 43], [5, 45], [45, 44], [44, 5], [45,
#     46], [46, 44], [46, 16], [16, 44], [45, 13], [13, 46], [23, 
#    47], [47, 38], [47, 48], [48, 38], [48, 30], [47, 18], [18, 
#    48], [5, 50], [50, 49], [49, 5], [50, 51], [51, 49], [51, 14], [14,
#     49], [50, 15], [15, 51], [20, 53], [53, 52], [52, 20], [53, 
#    41], [41, 52], [31, 52], [53, 24], [8, 55], [55, 54], [54, 8], [55,
#     56], [56, 54], [56, 2], [2, 54], [55, 11], [11, 56], [32, 
#    57], [57, 6], [32, 47], [47, 57], [23, 57], [2, 59], [59, 58], [58,
#     2], [59, 60], [60, 58], [60, 9], [9, 58], [59, 10], [10, 60], [7, 
#    61], [61, 35], [61, 53], [53, 35], [61, 24], [12, 63], [63, 
#    62], [62, 12], [63, 45], [45, 62], [5, 62], [63, 13], [49, 
#    62], [49, 64], [64, 62], [64, 12], [14, 64], [57, 65], [65, 
#    6], [57, 66], [66, 65], [66, 17], [17, 65], [23, 66], [7, 67], [67,
#     61], [67, 68], [68, 61], [68, 24], [67, 19], [19, 68], [3, 
#    70], [70, 69], [69, 3], [70, 71], [71, 69], [71, 21], [21, 
#    69], [70, 0], [0, 71], [71, 72], [72, 21], [71, 73], [73, 72], [73,
#     4], [4, 72], [0, 73], [8, 75], [75, 74], [74, 8], [75, 70], [70, 
#    74], [3, 74], [75, 0], [0, 76], [76, 73], [76, 77], [77, 73], [77, 
#    4], [76, 9], [9, 77], [25, 79], [79, 78], [78, 25], [79, 80], [80, 
#    78], [80, 30], [30, 78], [79, 16], [16, 80], [31, 82], [82, 
#    81], [81, 31], [82, 83], [83, 81], [83, 26], [26, 81], [82, 
#    15], [15, 83], [2, 84], [84, 54], [84, 75], [75, 54], [84, 0], [58,
#     84], [58, 76], [76, 84], [27, 86], [86, 85], [85, 27], [86, 
#    63], [63, 85], [12, 85], [86, 13], [64, 87], [87, 12], [64, 
#    88], [88, 87], [88, 29], [29, 87], [14, 88], [17, 89], [89, 
#    65], [89, 90], [90, 65], [90, 6], [89, 11], [11, 90], [7, 91], [91,
#     67], [91, 92], [92, 67], [92, 19], [91, 10], [10, 92], [15, 
#    94], [94, 93], [93, 15], [94, 95], [95, 93], [95, 28], [28, 
#    93], [94, 16], [16, 95], [10, 97], [97, 96], [96, 10], [97, 
#    98], [98, 96], [98, 1], [1, 96], [97, 11], [11, 98], [18, 99], [99,
#     48], [99, 78], [78, 48], [99, 25], [26, 100], [100, 81], [100, 
#    52], [52, 81], [100, 20], [95, 101], [101, 28], [95, 79], [79, 
#    101], [25, 101], [83, 102], [102, 26], [83, 93], [93, 102], [28, 
#    102], [85, 103], [103, 27], [85, 104], [104, 103], [104, 22], [22, 
#    103], [12, 104], [104, 105], [105, 22], [104, 87], [87, 105], [29, 
#    105], [22, 106], [106, 103], [106, 107], [107, 103], [107, 
#    27], [106, 17], [17, 107], [29, 108], [108, 105], [108, 109], [109,
#     105], [109, 22], [108, 19], [19, 109], [1, 111], [111, 110], [110,
#     1], [111, 106], [106, 110], [22, 110], [111, 17], [109, 
#    110], [109, 112], [112, 110], [112, 1], [19, 112], [34, 113], [113,
#     18], [34, 74], [74, 113], [3, 113], [77, 114], [114, 4], [77, 
#    36], [36, 114], [20, 114], [40, 115], [115, 23], [40, 86], [86, 
#    115], [27, 115], [88, 116], [116, 29], [88, 42], [42, 116], [24, 
#    116], [25, 117], [117, 101], [117, 118], [118, 101], [118, 
#    28], [117, 21], [21, 118], [21, 119], [119, 118], [119, 102], [102,
#     118], [119, 26], [3, 120], [120, 113], [120, 99], [99, 113], [120,
#     25], [114, 121], [121, 4], [114, 100], [100, 121], [26, 121], [66,
#     107], [66, 115], [115, 107], [68, 116], [68, 108], [108, 
#    116], [98, 111], [98, 89], [89, 111], [92, 112], [92, 96], [96, 
#    112], [56, 59], [56, 97], [97, 59], [69, 120], [69, 117], [117, 
#    120], [121, 72], [121, 119], [119, 72], [44, 50], [44, 94], [94, 
#    50], [46, 80], [46, 39], [39, 80], [51, 43], [51, 82], [82, 
#    43], [90, 33], [90, 55], [55, 33], [60, 37], [60, 91], [91, 
#    37]], [[6, 33, 32], [32, 33, 34], [32, 34, 18], [33, 8, 34], [20, 
#    36, 35], [35, 36, 37], [35, 37, 7], [36, 9, 37], [30, 39, 38], [38,
#     39, 40], [38, 40, 23], [39, 13, 40], [24, 42, 41], [41, 42, 
#    43], [41, 43, 31], [42, 14, 43], [5, 45, 44], [44, 45, 46], [44, 
#    46, 16], [45, 13, 46], [23, 47, 38], [38, 47, 48], [38, 48, 
#    30], [47, 18, 48], [5, 50, 49], [49, 50, 51], [49, 51, 14], [50, 
#    15, 51], [20, 53, 52], [52, 53, 41], [52, 41, 31], [53, 24, 
#    41], [8, 55, 54], [54, 55, 56], [54, 56, 2], [55, 11, 56], [6, 32, 
#    57], [57, 32, 47], [57, 47, 23], [32, 18, 47], [2, 59, 58], [58, 
#    59, 60], [58, 60, 9], [59, 10, 60], [7, 61, 35], [35, 61, 53], [35,
#     53, 20], [61, 24, 53], [12, 63, 62], [62, 63, 45], [62, 45, 
#    5], [63, 13, 45], [5, 49, 62], [62, 49, 64], [62, 64, 12], [49, 14,
#     64], [6, 57, 65], [65, 57, 66], [65, 66, 17], [57, 23, 66], [7, 
#    67, 61], [61, 67, 68], [61, 68, 24], [67, 19, 68], [3, 70, 
#    69], [69, 70, 71], [69, 71, 21], [70, 0, 71], [21, 71, 72], [72, 
#    71, 73], [72, 73, 4], [71, 0, 73], [8, 75, 74], [74, 75, 70], [74, 
#    70, 3], [75, 0, 70], [0, 76, 73], [73, 76, 77], [73, 77, 4], [76, 
#    9, 77], [25, 79, 78], [78, 79, 80], [78, 80, 30], [79, 16, 
#    80], [31, 82, 81], [81, 82, 83], [81, 83, 26], [82, 15, 83], [2, 
#    84, 54], [54, 84, 75], [54, 75, 8], [84, 0, 75], [2, 58, 84], [84, 
#    58, 76], [84, 76, 0], [58, 9, 76], [27, 86, 85], [85, 86, 63], [85,
#     63, 12], [86, 13, 63], [12, 64, 87], [87, 64, 88], [87, 88, 
#    29], [64, 14, 88], [17, 89, 65], [65, 89, 90], [65, 90, 6], [89, 
#    11, 90], [7, 91, 67], [67, 91, 92], [67, 92, 19], [91, 10, 
#    92], [15, 94, 93], [93, 94, 95], [93, 95, 28], [94, 16, 95], [10, 
#    97, 96], [96, 97, 98], [96, 98, 1], [97, 11, 98], [18, 99, 
#    48], [48, 99, 78], [48, 78, 30], [99, 25, 78], [26, 100, 81], [81, 
#    100, 52], [81, 52, 31], [100, 20, 52], [28, 95, 101], [101, 95, 
#    79], [101, 79, 25], [95, 16, 79], [26, 83, 102], [102, 83, 
#    93], [102, 93, 28], [83, 15, 93], [27, 85, 103], [103, 85, 
#    104], [103, 104, 22], [85, 12, 104], [22, 104, 105], [105, 104, 
#    87], [105, 87, 29], [104, 12, 87], [22, 106, 103], [103, 106, 
#    107], [103, 107, 27], [106, 17, 107], [29, 108, 105], [105, 108, 
#    109], [105, 109, 22], [108, 19, 109], [1, 111, 110], [110, 111, 
#    106], [110, 106, 22], [111, 17, 106], [22, 109, 110], [110, 109, 
#    112], [110, 112, 1], [109, 19, 112], [18, 34, 113], [113, 34, 
#    74], [113, 74, 3], [34, 8, 74], [4, 77, 114], [114, 77, 36], [114, 
#    36, 20], [77, 9, 36], [23, 40, 115], [115, 40, 86], [115, 86, 
#    27], [40, 13, 86], [29, 88, 116], [116, 88, 42], [116, 42, 
#    24], [88, 14, 42], [25, 117, 101], [101, 117, 118], [101, 118, 
#    28], [117, 21, 118], [21, 119, 118], [118, 119, 102], [118, 102, 
#    28], [119, 26, 102], [3, 120, 113], [113, 120, 99], [113, 99, 
#    18], [120, 25, 99], [4, 114, 121], [121, 114, 100], [121, 100, 
#    26], [114, 20, 100], [17, 66, 107], [107, 66, 115], [107, 115, 
#    27], [66, 23, 115], [24, 68, 116], [116, 68, 108], [116, 108, 
#    29], [68, 19, 108], [1, 98, 111], [111, 98, 89], [111, 89, 
#    17], [98, 11, 89], [19, 92, 112], [112, 92, 96], [112, 96, 1], [92,
#     10, 96], [2, 56, 59], [59, 56, 97], [59, 97, 10], [56, 11, 
#    97], [3, 69, 120], [120, 69, 117], [120, 117, 25], [69, 21, 
#    117], [4, 121, 72], [72, 121, 119], [72, 119, 21], [121, 26, 
#    119], [5, 44, 50], [50, 44, 94], [50, 94, 15], [44, 16, 94], [16, 
#    46, 80], [80, 46, 39], [80, 39, 30], [46, 13, 39], [14, 51, 
#    43], [43, 51, 82], [43, 82, 31], [51, 15, 82], [6, 90, 33], [33, 
#    90, 55], [33, 55, 8], [90, 11, 55], [9, 60, 37], [37, 60, 91], [37,
#     91, 7], [60, 10, 91]]]

# mesh=[ # Ball Mesh (with interior)
#     [[0.999393, 0.658086, -3.01143], [1.00089, 1.11009, -0.0498197], [1.,
#     0.100005, -1.56078], [0.999277, 1.16715, -2.47563], [0.999277, 
#    1.04971, 2.55674], [1., 3.04159, 1.56078], [1.00028, 
#    1.20258, -1.26899], [1.00028, 1.01248, 1.2377], [0.999813, 
#    0.747806, -1.8488], [0.999813, 0.557686, 1.93119], [1.00049, 
#    0.598997, 0.51067], [1.00049, 0.715614, -0.723146], [1.00061, 
#    2.48194, 0.129736], [1.00019, 2.58331, -1.20687], [1.00019, 
#    2.39338, 1.28996], [0.999509, 2.42711, 2.41643], [0.999509, 
#    2.54404, -2.62918], [1.00079, 1.44152, -0.640642], [0.999697, 
#    1.47724, -1.87963], [1.00079, 1.3242, 0.609696], [0.999697, 1.287, 
#    1.8915], [0.999018, 1.38285, -3.12251], [1.00098, 1.75837, 
#    0.0190448], [1.0003, 1.85442, -1.24812], [1.0003, 1.6643, 
#    1.26004], [0.999206, 1.81779, -2.53071], [0.999206, 1.70028, 
#    2.49974], [1.00072, 2.09106, -0.583582], [0.999106, 2.03239, 
#    3.09166], [1.00072, 1.97383, 0.664618], [0.999724, 
#    2.12945, -1.90166], [0.999724, 1.93923, 1.87055], [0.999986, 
#    1.3291, -1.58452], [1.00005, 0.955813, -1.51216], [0.999738, 
#    1.11246, -1.8672], [0.999986, 1.12912, 1.58554], [0.999738, 
#    0.922248, 1.90569], [1.00005, 0.756219, 1.50098], [1.00001, 
#    2.01246, -1.55385], [0.999954, 2.38547, -1.63771], [1.00026, 
#    2.21895, -1.23354], [1.00001, 1.81248, 1.55501], [1.00026, 2.02887,
#     1.27226], [0.999954, 2.18585, 1.62699], [0.999741, 
#    2.86354, -2.79649], [1.0001, 2.90812, -1.1238], [0.999838, 
#    2.68252, -1.94382], [1., 1.6708, -1.56979], [0.999694, 
#    1.80336, -1.88982], [1.0001, 2.719, 1.32447], [0.999741, 2.74915, 
#    2.31228], [0.999838, 2.49247, 1.84123], [0.999694, 1.61312, 
#    1.88123], [1., 1.4708, 1.56979], [0.999901, 
#    0.422157, -1.81239], [1.00016, 0.649552, -1.29718], [1.00026, 
#    0.393693, -0.825473], [1.00031, 1.5285, -1.25846], [0.999901, 
#    0.232642, 2.00996], [1.00026, 0.279859, 0.342655], [1.00016, 
#    0.459731, 1.19358], [1.00031, 1.33838, 1.24982], [1.00032, 2.80005,
#     0.286145], [1.00043, 2.64013, -0.481107], [1.00043, 2.52388, 
#    0.743981], [1.00057, 1.30984, -0.944873], [1.00059, 
#    1.6516, -0.939285], [1.00057, 1.15008, 0.901945], [1.00059, 
#    1.48999, 0.939285], [0.9991, 1.25984, -2.81011], [0.999298, 
#    0.89572, -2.68842], [0.999149, 1.01978, -3.0799], [0.9991, 1.201, 
#    2.87807], [0.999298, 0.822485, 2.8498], [0.999519, 
#    0.934302, -2.21069], [0.999575, 0.616516, -2.39527], [0.999575, 
#    0.499913, 2.65855], [0.999519, 0.780318, 2.32207], [0.999435, 
#    1.99202, -2.23793], [0.999312, 2.18147, -2.56691], [0.999595, 
#    2.36905, -2.18859], [0.999435, 1.83205, 2.19504], [0.999595, 
#    2.20041, 2.09462], [0.999312, 2.06407, 2.46664], [0.99968, 
#    0.339735, -2.85375], [1.0007, 2.31781, -0.291013], [1.00048, 
#    2.3603, -0.817452], [1.0007, 2.24475, 0.452056], [1.00048, 2.20658,
#     0.928905], [1.00069, 1.07826, -0.673532], [1.00041, 
#    0.941774, -1.04484], [1.00041, 0.773372, 0.950672], [1.00069, 
#    0.96109, 0.573353], [0.999269, 2.25736, 2.80831], [0.999475, 
#    2.58082, 2.98114], [0.999269, 2.30705, -2.97613], [1.00073, 
#    0.835869, 0.165022], [1.00053, 0.562441, -0.159852], [1.00073, 
#    0.885432, -0.332439], [0.999413, 1.6517, -2.20069], [0.999413, 
#    1.48989, 2.20069], [0.999109, 1.94351, -2.84745], [0.999109, 
#    1.87889, 2.78015], [1.0009, 1.93989, -0.262968], [1.00085, 2.12076,
#     0.0615502], [1.0009, 1.88117, 0.330803], [1.00095, 
#    1.60162, -0.312383], [1.0008, 1.76636, -0.614048], [1.0008, 
#    1.64904, 0.636464], [1.00095, 1.53997, 0.312383], [1.00099, 
#    1.43416, -0.0137963], [1.00089, 1.26327, -0.3607], [1.00089, 
#    1.19878, 0.293516], [0.999458, 1.31129, -2.16543], [0.999458, 
#    1.14774, 2.20657], [1.00054, 1.99336, -0.933262], [1.00054, 
#    1.83002, 0.974449], [0.999049, 1.60168, -2.82859], [0.999009, 
#    1.70771, 3.12777], [0.999049, 1.53991, 2.82859], [0.999199, 
#    1.49243, -2.50394], [0.999199, 1.37491, 2.52637], [0.001, 
#    1.5708, -1.43534e-13], [0.509796, 2.00036, 2.07729], [0.509663, 
#    1.49245, -2.07883], [0.511672, 1.70348, 0.43671], [0.509182, 
#    1.38583, 2.95699], [0.510636, 1.82273, -1.04273], [0.509797, 
#    2.5631, -2.26781], [0.510482, 0.812259, 1.22628], [0.510077, 
#    0.270465, -2.20977], [0.621851, 2.69799, 1.81492], [0.62354, 
#    1.41751, -0.220715], [0.623408, 2.13147, -0.1801], [0.642723, 
#    2.3195, 0.70481], [0.671115, 1.52895, 2.40348], [0.627744, 
#    1.0837, -2.66388], [0.629915, 2.06484, 2.8459], [0.623454, 
#    1.77716, -2.73141], [0.668945, 1.84396, -1.62991], [0.618909, 
#    1.10816, -0.902222], [0.321724, 2.04155, -1.70564], [0.655073, 
#    2.40202, -1.27394], [0.383031, 1.65163, 1.27893], [0.66053, 
#    1.32351, 0.888537], [0.365202, 0.734168, 2.40176], [0.631585, 
#    0.462118, 0.173953], [0.63245, 0.902617, -1.72511], [0.33409, 
#    2.60015, 2.60339], [0.707174, 1.60665, -0.660909], [0.33558, 
#    1.779, -0.320757], [0.658302, 2.15356, 1.41597], [0.322916, 
#    0.922739, -2.44994], [0.656547, 2.0199, -2.21759], [0.676885, 
#    2.26846, -2.873], [0.682437, 0.568492, -0.99342], [0.689518, 
#    1.37978, -1.38872], [0.635119, 2.9319, -0.559428], [0.663695, 
#    1.84271, 0.951986], [0.682555, 1.6455, 1.66075], [0.663053, 
#    1.03589, 2.54101], [0.684805, 0.742245, 1.97084], [0.31717, 
#    0.396695, 0.311314], [0.663033, 0.897327, -0.321662], [0.663997, 
#    1.02493, 0.364887], [0.40786, 2.41506, 1.19836], [0.324498, 
#    1.82199, -2.88954], [0.388408, 1.19003, -1.38443], [0.33957, 
#    2.72374, -0.545928], [0.481642, 1.35978, 1.98326], [0.708568, 
#    1.2313, 1.41239], [0.655247, 0.682401, 3.10212], [0.675034, 
#    0.264489, 1.67345]], [[30, 78], [78, 80], [80, 30], [30, 
#    153], [153, 78], [80, 153], [124, 152], [152, 136], [136, 
#    124], [124, 166], [166, 152], [136, 166], [96, 163], [163, 1], [1, 
#    96], [96, 164], [164, 163], [1, 164], [85, 86], [86, 63], [63, 
#    85], [85, 133], [133, 86], [63, 133], [8, 34], [34, 33], [33, 
#    8], [8, 147], [147, 34], [33, 147], [88, 14], [14, 42], [42, 
#    88], [88, 151], [151, 14], [42, 151], [127, 150], [150, 141], [141,
#     127], [127, 168], [168, 150], [141, 168], [150, 140], [140, 
#    127], [127, 167], [167, 150], [140, 167], [126, 138], [138, 
#    136], [136, 126], [126, 166], [166, 138], [48, 139], [139, 
#    124], [124, 48], [48, 153], [153, 139], [124, 153], [21, 69], [69, 
#    71], [71, 21], [21, 136], [136, 69], [71, 136], [97, 10], [10, 
#    59], [59, 97], [97, 146], [146, 10], [59, 146], [130, 162], [162, 
#    146], [146, 130], [130, 172], [172, 162], [146, 172], [43, 
#    51], [51, 82], [82, 43], [43, 151], [151, 51], [82, 151], [119, 
#    102], [102, 118], [118, 119], [119, 137], [137, 102], [118, 
#    137], [31, 43], [82, 31], [31, 151], [140, 162], [162, 155], [155, 
#    140], [167, 162], [155, 167], [132, 133], [133, 125], [125, 
#    132], [132, 150], [150, 133], [125, 150], [125, 143], [143, 
#    129], [129, 125], [125, 162], [162, 143], [129, 162], [83, 
#    81], [81, 82], [82, 83], [83, 123], [123, 81], [82, 123], [122, 
#    150], [141, 122], [122, 167], [141, 167], [71, 72], [72, 21], [21, 
#    126], [126, 71], [72, 126], [64, 12], [12, 62], [62, 64], [64, 
#    134], [134, 12], [62, 134], [139, 141], [141, 128], [128, 
#    139], [139, 142], [142, 141], [128, 142], [82, 15], [15, 83], [15, 
#    123], [81, 135], [135, 52], [52, 81], [81, 159], [159, 135], [52, 
#    159], [129, 144], [144, 143], [125, 144], [67, 19], [19, 68], [68, 
#    67], [67, 144], [144, 19], [68, 144], [56, 54], [54, 55], [55, 
#    56], [56, 155], [155, 54], [55, 155], [47, 139], [139, 57], [57, 
#    47], [47, 156], [156, 139], [57, 156], [95, 94], [94, 16], [16, 
#    95], [95, 154], [154, 94], [16, 154], [29, 134], [134, 88], [88, 
#    29], [29, 158], [158, 134], [88, 158], [18, 139], [47, 18], [18, 
#    156], [115, 127], [127, 27], [27, 115], [115, 149], [149, 
#    127], [27, 149], [124, 99], [99, 48], [99, 153], [12, 104], [104, 
#    134], [134, 87], [87, 12], [104, 87], [92, 19], [67, 92], [92, 
#    144], [66, 107], [107, 17], [17, 66], [66, 149], [149, 107], [17, 
#    149], [122, 143], [125, 122], [122, 162], [12, 133], [63, 12], [12,
#     157], [157, 133], [63, 157], [76, 58], [58, 9], [9, 76], [76, 
#    172], [172, 58], [9, 172], [155, 147], [147, 140], [147, 
#    167], [133, 149], [127, 133], [150, 149], [137, 148], [148, 
#    131], [131, 137], [137, 154], [154, 148], [131, 154], [69, 
#    138], [21, 138], [141, 148], [148, 128], [168, 148], [128, 
#    168], [102, 135], [135, 26], [26, 102], [137, 135], [26, 
#    137], [121, 26], [26, 119], [119, 121], [121, 135], [119, 
#    135], [91, 92], [67, 91], [91, 144], [160, 161], [161, 145], [145, 
#    160], [160, 171], [171, 161], [145, 171], [130, 152], [152, 
#    147], [147, 130], [130, 167], [167, 152], [39, 128], [128, 
#    46], [46, 39], [39, 142], [46, 142], [38, 139], [139, 39], [39, 
#    38], [38, 142], [41, 43], [31, 41], [41, 151], [78, 48], [99, 
#    78], [73, 71], [71, 0], [0, 73], [73, 171], [171, 71], [0, 
#    171], [130, 155], [155, 146], [66, 127], [127, 156], [156, 
#    149], [66, 156], [89, 140], [140, 17], [17, 89], [89, 149], [149, 
#    140], [44, 131], [131, 5], [5, 44], [44, 157], [157, 131], [5, 
#    157], [132, 22], [22, 125], [22, 133], [105, 133], [133, 
#    104], [104, 105], [105, 134], [134, 133], [118, 126], [126, 
#    119], [137, 126], [110, 111], [111, 106], [106, 110], [110, 
#    132], [132, 111], [106, 132], [140, 111], [111, 89], [89, 
#    163], [163, 140], [111, 163], [5, 50], [50, 49], [49, 5], [131, 
#    50], [49, 131], [54, 130], [130, 75], [75, 54], [54, 147], [75, 
#    147], [132, 103], [103, 22], [103, 133], [75, 136], [136, 74], [74,
#     75], [147, 136], [74, 147], [19, 164], [164, 144], [92, 164], [24,
#     158], [158, 151], [151, 24], [24, 159], [159, 158], [151, 
#    159], [6, 140], [140, 33], [33, 6], [6, 156], [156, 140], [33, 
#    156], [128, 153], [153, 142], [39, 153], [91, 129], [129, 60], [60,
#     91], [91, 146], [146, 129], [60, 146], [133, 27], [27, 86], [86, 
#    142], [142, 133], [27, 142], [88, 116], [116, 29], [158, 116], [14,
#     51], [43, 14], [74, 70], [70, 3], [3, 74], [136, 70], [3, 
#    136], [89, 11], [11, 90], [90, 89], [140, 11], [90, 140], [84, 
#    130], [130, 2], [2, 84], [84, 172], [2, 172], [101, 28], [28, 
#    95], [95, 101], [101, 154], [154, 28], [26, 81], [83, 26], [83, 
#    135], [80, 39], [39, 30], [113, 74], [3, 113], [113, 136], [124, 
#    147], [124, 167], [97, 98], [98, 96], [96, 97], [97, 163], [163, 
#    98], [20, 135], [135, 114], [114, 20], [20, 169], [169, 135], [114,
#     169], [40, 115], [115, 23], [23, 40], [40, 142], [142, 115], [23, 
#    142], [108, 144], [125, 108], [108, 158], [158, 144], [125, 
#    158], [152, 145], [145, 130], [130, 171], [171, 152], [52, 
#    169], [169, 100], [100, 135], [52, 100], [81, 31], [31, 123], [100,
#     81], [26, 100], [55, 8], [33, 55], [55, 147], [20, 53], [53, 
#    52], [52, 20], [20, 159], [159, 53], [126, 135], [132, 140], [132, 
#    149], [111, 149], [118, 28], [101, 118], [118, 138], [138, 
#    28], [101, 138], [134, 157], [157, 49], [49, 134], [134, 131], [23,
#     38], [38, 40], [40, 139], [139, 23], [91, 164], [137, 123], [123, 
#    131], [123, 148], [77, 76], [9, 77], [77, 161], [161, 76], [9, 
#    161], [114, 100], [100, 121], [121, 114], [58, 60], [60, 9], [60, 
#    172], [150, 162], [56, 97], [59, 56], [56, 146], [69, 70], [70, 
#    71], [41, 53], [53, 24], [24, 41], [41, 159], [93, 137], [137, 
#    94], [94, 93], [93, 154], [142, 127], [75, 70], [47, 48], [48, 
#    38], [38, 47], [18, 124], [48, 18], [44, 128], [128, 16], [16, 
#    44], [44, 154], [154, 128], [114, 36], [36, 20], [114, 161], [161, 
#    36], [20, 161], [48, 30], [30, 38], [30, 139], [130, 136], [55, 
#    11], [11, 56], [155, 11], [120, 124], [124, 113], [113, 120], [120,
#     136], [22, 106], [106, 103], [70, 171], [171, 136], [75, 
#    171], [87, 105], [4, 77], [77, 114], [114, 4], [4, 160], [160, 
#    77], [114, 160], [162, 163], [163, 146], [162, 164], [146, 
#    164], [23, 127], [127, 57], [57, 23], [23, 156], [157, 148], [131, 
#    168], [168, 157], [64, 49], [157, 64], [62, 49], [157, 62], [66, 
#    57], [109, 125], [125, 19], [19, 109], [109, 164], [164, 
#    125], [103, 149], [106, 149], [169, 148], [148, 143], [143, 
#    169], [169, 123], [143, 123], [142, 157], [142, 168], [133, 
#    168], [129, 164], [137, 28], [138, 137], [90, 65], [65, 89], [65, 
#    140], [157, 165], [165, 134], [168, 165], [134, 168], [169, 
#    122], [148, 122], [83, 102], [137, 83], [155, 163], [53, 
#    170], [170, 159], [20, 170], [124, 156], [15, 131], [131, 94], [94,
#     15], [15, 137], [37, 36], [36, 9], [9, 37], [37, 161], [113, 
#    147], [109, 132], [164, 132], [161, 169], [169, 129], [129, 
#    161], [161, 170], [170, 169], [129, 170], [17, 111], [160, 
#    135], [121, 160], [125, 134], [165, 158], [125, 165], [37, 
#    129], [129, 7], [7, 37], [37, 170], [7, 170], [134, 14], [151, 
#    134], [31, 159], [63, 142], [142, 13], [13, 63], [13, 157], [10, 
#    91], [10, 164], [7, 35], [35, 37], [170, 35], [95, 93], [158, 
#    143], [143, 165], [122, 152], [145, 122], [162, 152], [145, 
#    162], [23, 66], [128, 166], [166, 148], [141, 166], [143, 
#    170], [63, 62], [152, 126], [80, 79], [79, 16], [16, 80], [80, 
#    154], [154, 79], [119, 160], [126, 160], [46, 157], [128, 
#    157], [131, 165], [29, 105], [87, 29], [29, 125], [125, 105], [60, 
#    10], [59, 58], [58, 2], [2, 59], [59, 172], [138, 124], [151, 
#    123], [123, 159], [121, 4], [139, 167], [167, 156], [131, 
#    128], [128, 94], [105, 22], [22, 104], [110, 1], [1, 111], [132, 
#    1], [33, 155], [52, 31], [147, 18], [18, 34], [34, 156], [156, 
#    147], [139, 127], [80, 128], [154, 153], [96, 10], [96, 146], [8, 
#    74], [74, 34], [98, 11], [89, 98], [163, 11], [120, 99], [99, 
#    138], [120, 138], [98, 1], [40, 39], [39, 13], [13, 40], [28, 
#    93], [111, 98], [120, 25], [25, 99], [138, 25], [15, 50], [50, 
#    94], [15, 51], [51, 50], [131, 51], [153, 141], [141, 124], [166, 
#    153], [169, 159], [159, 143], [143, 151], [165, 151], [123, 
#    165], [106, 107], [107, 103], [142, 30], [49, 51], [14, 49], [14, 
#    131], [131, 82], [151, 131], [137, 166], [76, 73], [0, 76], [76, 
#    171], [106, 17], [126, 171], [2, 56], [146, 2], [77, 36], [122, 
#    166], [32, 34], [18, 32], [32, 156], [19, 112], [112, 109], [164, 
#    112], [153, 138], [85, 104], [104, 103], [103, 85], [86, 115], [40,
#     86], [165, 122], [165, 150], [75, 8], [8, 54], [42, 116], [42, 
#    158], [79, 138], [101, 79], [154, 138], [33, 32], [32, 6], [91, 
#    7], [7, 144], [79, 95], [135, 123], [149, 65], [65, 66], [65, 
#    156], [72, 119], [72, 160], [60, 59], [129, 172], [172, 161], [37, 
#    172], [2, 54], [2, 155], [145, 143], [1, 112], [112, 96], [152, 
#    141], [172, 171], [145, 172], [166, 154], [65, 57], [165, 
#    148], [41, 52], [97, 155], [122, 168], [32, 47], [57, 32], [24, 
#    42], [79, 25], [25, 153], [79, 153], [92, 112], [164, 150], [72, 
#    121], [108, 68], [68, 158], [109, 22], [17, 65], [69, 120], [44, 
#    46], [107, 27], [27, 103], [45, 44], [5, 45], [45, 157], [36, 
#    170], [36, 35], [118, 21], [68, 116], [116, 24], [24, 68], [115, 
#    66], [69, 117], [117, 120], [117, 138], [44, 94], [21, 117], [145, 
#    129], [145, 169], [57, 6], [20, 100], [91, 37], [37, 60], [126, 
#    145], [160, 169], [170, 144], [63, 45], [45, 62], [132, 163], [162,
#     132], [117, 25], [90, 33], [90, 147], [92, 10], [96, 92], [43, 
#    42], [90, 155], [64, 14], [88, 64], [87, 88], [18, 99], [93, 
#    83], [15, 93], [116, 108], [108, 29], [99, 113], [6, 90], [113, 
#    34], [41, 42], [11, 97], [85, 12], [24, 61], [61, 68], [144, 
#    24], [61, 144], [6, 65], [62, 5], [4, 72], [72, 73], [73, 4], [73, 
#    160], [108, 109], [109, 105], [105, 108], [13, 86], [119, 21], [22,
#     110], [79, 78], [78, 25], [64, 87], [27, 85], [13, 45], [108, 
#    19], [115, 107], [24, 170], [163, 150], [72, 171], [45, 46], [124, 
#    34], [101, 25], [117, 101], [73, 77], [145, 166], [118, 117], [46, 
#    16], [69, 3], [90, 55], [67, 7], [126, 123], [123, 166], [120, 
#    3], [58, 84], [44, 50], [113, 18], [28, 102], [102, 93], [47, 
#    23], [126, 169], [109, 110], [53, 61], [61, 170], [84, 171], [84, 
#    54], [46, 13], [46, 80], [61, 67], [84, 75], [84, 76], [0, 84], [0,
#     75], [61, 7], [67, 170], [0, 70], [35, 53], [20, 35], [112, 
#    110], [110, 164], [35, 61], [125, 168], [169, 166], [170, 
#    158], [77, 171]], [[30, 78, 80], [78, 30, 153], [30, 80, 153], [80,
#     78, 153], [124, 152, 136], [152, 124, 166], [124, 136, 166], [136,
#     152, 166], [96, 163, 1], [163, 96, 164], [96, 1, 164], [1, 163, 
#    164], [85, 86, 63], [86, 85, 133], [85, 63, 133], [63, 86, 
#    133], [8, 34, 33], [34, 8, 147], [8, 33, 147], [33, 34, 147], [88, 
#    14, 42], [14, 88, 151], [88, 42, 151], [42, 14, 151], [127, 150, 
#    141], [150, 127, 168], [127, 141, 168], [141, 150, 168], [127, 150,
#     140], [150, 127, 167], [127, 140, 167], [140, 150, 167], [126, 
#    138, 136], [138, 126, 166], [126, 136, 166], [136, 138, 166], [48, 
#    139, 124], [139, 48, 153], [48, 124, 153], [124, 139, 153], [21, 
#    69, 71], [69, 21, 136], [21, 71, 136], [71, 69, 136], [97, 10, 
#    59], [10, 97, 146], [97, 59, 146], [59, 10, 146], [130, 162, 
#    146], [162, 130, 172], [130, 146, 172], [146, 162, 172], [43, 51, 
#    82], [51, 43, 151], [43, 82, 151], [82, 51, 151], [119, 102, 
#    118], [102, 119, 137], [119, 118, 137], [118, 102, 137], [31, 43, 
#    82], [43, 31, 151], [31, 82, 151], [140, 162, 155], [162, 140, 
#    167], [140, 155, 167], [155, 162, 167], [132, 133, 125], [133, 132,
#     150], [132, 125, 150], [125, 133, 150], [125, 143, 129], [143, 
#    125, 162], [125, 129, 162], [129, 143, 162], [83, 81, 82], [81, 83,
#     123], [83, 82, 123], [82, 81, 123], [122, 150, 141], [150, 122, 
#    167], [122, 141, 167], [141, 150, 167], [21, 71, 72], [71, 21, 
#    126], [21, 72, 126], [72, 71, 126], [64, 12, 62], [12, 64, 
#    134], [64, 62, 134], [62, 12, 134], [139, 141, 128], [141, 139, 
#    142], [139, 128, 142], [128, 141, 142], [83, 82, 15], [83, 15, 
#    123], [15, 82, 123], [81, 135, 52], [135, 81, 159], [81, 52, 
#    159], [52, 135, 159], [143, 129, 144], [129, 125, 144], [125, 143, 
#    144], [67, 19, 68], [19, 67, 144], [67, 68, 144], [68, 19, 
#    144], [56, 54, 55], [54, 56, 155], [56, 55, 155], [55, 54, 
#    155], [47, 139, 57], [139, 47, 156], [47, 57, 156], [57, 139, 
#    156], [95, 94, 16], [94, 95, 154], [95, 16, 154], [16, 94, 
#    154], [29, 134, 88], [134, 29, 158], [29, 88, 158], [88, 134, 
#    158], [18, 139, 47], [139, 18, 156], [18, 47, 156], [115, 127, 
#    27], [127, 115, 149], [115, 27, 149], [27, 127, 149], [48, 124, 
#    99], [48, 99, 153], [99, 124, 153], [134, 12, 104], [12, 134, 
#    87], [134, 104, 87], [104, 12, 87], [92, 19, 67], [19, 92, 
#    144], [92, 67, 144], [66, 107, 17], [107, 66, 149], [66, 17, 
#    149], [17, 107, 149], [122, 143, 125], [143, 122, 162], [122, 125, 
#    162], [12, 133, 63], [133, 12, 157], [12, 63, 157], [63, 133, 
#    157], [76, 58, 9], [58, 76, 172], [76, 9, 172], [9, 58, 172], [140,
#     155, 147], [140, 147, 167], [147, 155, 167], [133, 149, 
#    127], [149, 133, 150], [133, 127, 150], [127, 149, 150], [137, 148,
#     131], [148, 137, 154], [137, 131, 154], [131, 148, 154], [136, 69,
#     138], [69, 21, 138], [21, 136, 138], [141, 148, 128], [148, 141, 
#    168], [141, 128, 168], [128, 148, 168], [102, 135, 26], [135, 102, 
#    137], [102, 26, 137], [26, 135, 137], [121, 26, 119], [26, 121, 
#    135], [121, 119, 135], [119, 26, 135], [91, 92, 67], [92, 91, 
#    144], [91, 67, 144], [160, 161, 145], [161, 160, 171], [160, 145, 
#    171], [145, 161, 171], [130, 152, 147], [152, 130, 167], [130, 147,
#     167], [147, 152, 167], [39, 128, 46], [128, 39, 142], [39, 46, 
#    142], [46, 128, 142], [38, 139, 39], [139, 38, 142], [38, 39, 
#    142], [39, 139, 142], [41, 43, 31], [43, 41, 151], [41, 31, 
#    151], [78, 48, 99], [48, 78, 153], [78, 99, 153], [73, 71, 0], [71,
#     73, 171], [73, 0, 171], [0, 71, 171], [130, 155, 146], [155, 130, 
#    162], [146, 155, 162], [127, 149, 66], [149, 127, 156], [127, 66, 
#    156], [66, 149, 156], [89, 140, 17], [140, 89, 149], [89, 17, 
#    149], [17, 140, 149], [44, 131, 5], [131, 44, 157], [44, 5, 
#    157], [5, 131, 157], [125, 132, 22], [125, 22, 133], [22, 132, 
#    133], [105, 133, 104], [133, 105, 134], [105, 104, 134], [104, 133,
#     134], [118, 126, 119], [126, 118, 137], [119, 126, 137], [110, 
#    111, 106], [111, 110, 132], [110, 106, 132], [106, 111, 132], [89, 
#    140, 111], [140, 89, 163], [89, 111, 163], [111, 140, 163], [5, 50,
#     49], [50, 5, 131], [5, 49, 131], [49, 50, 131], [54, 130, 
#    75], [130, 54, 147], [54, 75, 147], [75, 130, 147], [22, 132, 
#    103], [22, 103, 133], [103, 132, 133], [75, 136, 74], [136, 75, 
#    147], [75, 74, 147], [74, 136, 147], [119, 135, 102], [135, 119, 
#    137], [144, 19, 164], [19, 92, 164], [92, 144, 164], [24, 158, 
#    151], [158, 24, 159], [24, 151, 159], [151, 158, 159], [6, 140, 
#    33], [140, 6, 156], [6, 33, 156], [33, 140, 156], [142, 128, 
#    153], [128, 39, 153], [39, 142, 153], [91, 129, 60], [129, 91, 
#    146], [91, 60, 146], [60, 129, 146], [86, 133, 27], [133, 86, 
#    142], [86, 27, 142], [27, 133, 142], [88, 116, 29], [116, 88, 
#    158], [29, 116, 158], [14, 51, 43], [51, 14, 151], [14, 43, 
#    151], [74, 70, 3], [70, 74, 136], [74, 3, 136], [3, 70, 136], [89, 
#    11, 90], [11, 89, 140], [89, 90, 140], [90, 11, 140], [84, 130, 
#    2], [130, 84, 172], [84, 2, 172], [2, 130, 172], [101, 28, 
#    95], [28, 101, 154], [101, 95, 154], [95, 28, 154], [26, 81, 
#    83], [81, 26, 135], [26, 83, 135], [83, 81, 135], [30, 80, 
#    39], [30, 39, 153], [39, 80, 153], [147, 130, 155], [130, 54, 
#    155], [54, 147, 155], [113, 74, 3], [74, 113, 136], [113, 3, 
#    136], [147, 152, 124], [147, 124, 167], [124, 152, 167], [97, 98, 
#    96], [98, 97, 163], [97, 96, 163], [96, 98, 163], [20, 135, 
#    114], [135, 20, 169], [20, 114, 169], [114, 135, 169], [40, 115, 
#    23], [115, 40, 142], [40, 23, 142], [23, 115, 142], [108, 144, 
#    125], [144, 108, 158], [108, 125, 158], [125, 144, 158], [130, 152,
#     145], [152, 130, 171], [130, 145, 171], [145, 152, 171], [169, 
#    135, 52], [135, 169, 100], [169, 52, 100], [52, 135, 100], [82, 81,
#     31], [82, 31, 123], [31, 81, 123], [100, 81, 26], [81, 100, 
#    135], [100, 26, 135], [55, 8, 33], [8, 55, 147], [55, 33, 
#    147], [20, 53, 52], [53, 20, 159], [20, 52, 159], [52, 53, 
#    159], [126, 135, 119], [135, 126, 137], [132, 140, 111], [140, 132,
#     149], [132, 111, 149], [111, 140, 149], [118, 28, 101], [28, 118, 
#    138], [118, 101, 138], [101, 28, 138], [134, 157, 49], [157, 134, 
#    131], [134, 49, 131], [49, 157, 131], [40, 23, 38], [23, 40, 
#    139], [40, 38, 139], [38, 23, 139], [92, 91, 164], [91, 144, 
#    164], [131, 137, 123], [131, 123, 148], [123, 137, 148], [77, 76, 
#    9], [76, 77, 161], [77, 9, 161], [9, 76, 161], [114, 100, 
#    121], [100, 114, 135], [114, 121, 135], [121, 100, 135], [9, 58, 
#    60], [9, 60, 172], [60, 58, 172], [150, 162, 140], [162, 150, 
#    167], [56, 97, 59], [97, 56, 146], [56, 59, 146], [71, 69, 
#    70], [71, 70, 136], [70, 69, 136], [41, 53, 24], [53, 41, 
#    159], [41, 24, 159], [24, 53, 159], [93, 137, 94], [137, 93, 
#    154], [93, 94, 154], [94, 137, 154], [127, 27, 142], [27, 115, 
#    142], [115, 127, 142], [75, 70, 74], [70, 75, 136], [47, 48, 
#    38], [48, 47, 139], [47, 38, 139], [38, 48, 139], [18, 124, 
#    48], [124, 18, 139], [18, 48, 139], [44, 128, 16], [128, 44, 
#    154], [44, 16, 154], [16, 128, 154], [114, 36, 20], [36, 114, 
#    161], [114, 20, 161], [20, 36, 161], [38, 48, 30], [38, 30, 
#    139], [30, 48, 139], [136, 147, 130], [147, 136, 152], [136, 130, 
#    152], [55, 11, 56], [11, 55, 155], [56, 11, 155], [120, 124, 
#    113], [124, 120, 136], [120, 113, 136], [113, 124, 136], [22, 106, 
#    103], [106, 22, 132], [103, 106, 132], [136, 70, 171], [70, 75, 
#    171], [75, 136, 171], [87, 105, 104], [105, 87, 134], [4, 77, 
#    114], [77, 4, 160], [4, 114, 160], [114, 77, 160], [162, 163, 
#    146], [163, 162, 164], [162, 146, 164], [146, 163, 164], [23, 127, 
#    57], [127, 23, 156], [23, 57, 156], [57, 127, 156], [131, 157, 
#    148], [157, 131, 168], [131, 148, 168], [148, 157, 168], [64, 49, 
#    157], [49, 64, 62], [64, 157, 62], [157, 49, 62], [24, 151, 
#    41], [41, 151, 159], [57, 127, 66], [57, 66, 156], [109, 125, 
#    19], [125, 109, 164], [109, 19, 164], [19, 125, 164], [132, 103, 
#    149], [103, 106, 149], [106, 132, 149], [139, 30, 153], [30, 48, 
#    153], [126, 71, 136], [21, 126, 136], [169, 148, 143], [148, 169, 
#    123], [169, 143, 123], [143, 148, 123], [21, 126, 138], [142, 157, 
#    133], [157, 142, 168], [142, 133, 168], [133, 157, 168], [146, 129,
#     164], [129, 91, 164], [91, 146, 164], [118, 137, 28], [137, 118, 
#    138], [28, 137, 138], [89, 90, 65], [89, 65, 140], [65, 90, 
#    140], [157, 165, 134], [165, 157, 168], [157, 134, 168], [134, 165,
#     168], [143, 169, 122], [169, 148, 122], [148, 143, 122], [26, 83, 
#    102], [83, 26, 137], [102, 83, 137], [146, 155, 163], [155, 162, 
#    163], [159, 53, 170], [53, 20, 170], [20, 159, 170], [139, 124, 
#    156], [124, 18, 156], [75, 136, 130], [75, 130, 171], [130, 136, 
#    171], [152, 136, 171], [15, 131, 94], [131, 15, 137], [15, 94, 
#    137], [94, 131, 137], [37, 36, 9], [36, 37, 161], [37, 9, 161], [9,
#     36, 161], [83, 135, 137], [142, 139, 153], [139, 128, 153], [74, 
#    113, 147], [113, 136, 147], [109, 132, 125], [132, 109, 164], [125,
#     132, 164], [161, 169, 129], [169, 161, 170], [161, 129, 
#    170], [129, 169, 170], [17, 111, 89], [111, 17, 149], [89, 111, 
#    149], [135, 114, 160], [114, 121, 160], [121, 135, 160], [134, 158,
#     125], [158, 134, 165], [134, 125, 165], [125, 158, 165], [37, 129,
#     7], [129, 37, 170], [37, 7, 170], [7, 129, 170], [88, 134, 
#    14], [134, 88, 151], [14, 134, 151], [41, 31, 159], [31, 151, 
#    159], [63, 142, 13], [142, 63, 157], [63, 13, 157], [13, 142, 
#    157], [91, 146, 10], [91, 10, 164], [10, 146, 164], [7, 35, 
#    37], [35, 7, 170], [37, 35, 170], [95, 93, 94], [93, 95, 
#    154], [125, 158, 143], [125, 143, 165], [143, 158, 165], [122, 152,
#     145], [152, 122, 162], [122, 145, 162], [145, 152, 162], [57, 23, 
#    66], [66, 23, 127], [148, 128, 166], [128, 141, 166], [141, 148, 
#    166], [129, 169, 143], [129, 143, 170], [143, 169, 170], [62, 12, 
#    63], [12, 62, 157], [62, 63, 157], [136, 152, 126], [126, 152, 
#    166], [80, 79, 16], [79, 80, 154], [80, 16, 154], [16, 79, 
#    154], [135, 119, 160], [119, 126, 160], [126, 135, 160], [142, 46, 
#    157], [46, 128, 157], [128, 142, 157], [131, 165, 157], [165, 131, 
#    168], [113, 124, 147], [124, 136, 147], [12, 134, 133], [134, 12, 
#    157], [133, 134, 157], [139, 40, 142], [40, 38, 142], [29, 105, 
#    87], [105, 29, 134], [29, 87, 134], [29, 125, 105], [125, 29, 
#    134], [105, 125, 134], [60, 10, 91], [10, 60, 146], [59, 58, 
#    2], [58, 59, 172], [59, 2, 172], [2, 58, 172], [162, 152, 
#    167], [152, 122, 167], [122, 162, 167], [136, 138, 124], [124, 138,
#     166], [31, 151, 123], [31, 123, 159], [123, 151, 159], [49, 134, 
#    64], [134, 157, 64], [4, 114, 121], [4, 121, 160], [156, 139, 
#    167], [139, 124, 167], [124, 156, 167], [94, 131, 128], [131, 94, 
#    154], [94, 128, 154], [128, 131, 154], [104, 105, 22], [104, 22, 
#    133], [22, 105, 133], [162, 125, 164], [125, 129, 164], [129, 162, 
#    164], [110, 1, 111], [1, 110, 132], [111, 1, 132], [147, 55, 
#    155], [55, 33, 155], [33, 147, 155], [81, 52, 31], [81, 31, 
#    159], [31, 52, 159], [34, 147, 18], [147, 34, 156], [34, 18, 156], 
#   [18, 147, 156], [127, 156, 139], [156, 127, 167], [127, 139, 
#    167], [27, 133, 127], [127, 133, 142], [128, 153, 80], [153, 128, 
#    154], [128, 80, 154], [80, 153, 154], [96, 10, 97], [10, 96, 
#    146], [96, 97, 146], [8, 74, 34], [74, 8, 147], [34, 74, 147], [98,
#     11, 89], [11, 98, 163], [98, 89, 163], [89, 11, 163], [99, 124, 
#    120], [124, 99, 138], [99, 120, 138], [120, 124, 138], [98, 1, 
#    96], [1, 98, 163], [40, 39, 13], [39, 40, 142], [40, 13, 142], [13,
#     39, 142], [95, 28, 93], [93, 28, 154], [89, 111, 98], [98, 111, 
#    163], [120, 25, 99], [25, 120, 138], [99, 25, 138], [141, 142, 
#    127], [142, 141, 168], [127, 142, 168], [15, 50, 94], [50, 15, 
#    131], [94, 50, 131], [15, 51, 50], [51, 15, 131], [50, 51, 
#    131], [124, 153, 141], [153, 124, 166], [124, 141, 166], [141, 153,
#     166], [143, 169, 159], [143, 159, 170], [159, 169, 170], [143, 
#    151, 123], [151, 143, 165], [143, 123, 165], [123, 151, 165], [106,
#     107, 103], [107, 106, 149], [103, 107, 149], [39, 142, 30], [30, 
#    142, 153], [127, 149, 140], [140, 149, 150], [49, 51, 14], [51, 49,
#     131], [49, 14, 131], [14, 51, 131], [51, 131, 82], [131, 51, 
#    151], [82, 131, 151], [137, 138, 126], [138, 137, 166], [137, 126, 
#    166], [76, 73, 0], [73, 76, 171], [76, 0, 171], [17, 107, 
#    106], [17, 106, 149], [152, 126, 171], [126, 136, 171], [123, 82, 
#    151], [160, 114, 161], [114, 77, 161], [77, 160, 161], [18, 147, 
#    124], [124, 147, 156], [59, 2, 56], [2, 59, 146], [56, 2, 
#    146], [114, 77, 36], [36, 77, 161], [141, 148, 122], [141, 122, 
#    166], [122, 148, 166], [32, 34, 18], [34, 32, 156], [32, 18, 
#    156], [19, 112, 109], [112, 19, 164], [109, 112, 164], [30, 39, 
#    38], [39, 30, 139], [138, 124, 153], [99, 138, 153], [85, 104, 
#    103], [104, 85, 133], [85, 103, 133], [103, 104, 133], [86, 115, 
#    40], [115, 86, 142], [86, 40, 142], [122, 125, 165], [125, 122, 
#    150], [122, 165, 150], [165, 125, 150], [28, 137, 93], [137, 28, 
#    154], [30, 48, 78], [54, 75, 8], [54, 8, 147], [8, 75, 147], [123, 
#    151, 131], [123, 131, 165], [131, 151, 165], [42, 116, 88], [116, 
#    42, 158], [42, 88, 158], [79, 138, 101], [138, 79, 154], [79, 101, 
#    154], [101, 138, 154], [33, 32, 6], [32, 33, 156], [6, 32, 
#    156], [7, 129, 91], [129, 7, 144], [7, 91, 144], [91, 129, 
#    144], [16, 79, 95], [95, 79, 154], [30, 142, 139], [123, 81, 
#    135], [83, 123, 135], [66, 149, 65], [66, 65, 156], [65, 149, 
#    156], [103, 104, 22], [129, 162, 146], [119, 126, 72], [119, 72, 
#    160], [72, 126, 160], [59, 10, 60], [59, 60, 146], [156, 34, 
#    33], [33, 34, 32], [18, 48, 47], [129, 161, 37], [161, 129, 
#    172], [129, 37, 172], [37, 161, 172], [2, 54, 56], [54, 2, 
#    155], [2, 56, 155], [151, 134, 158], [88, 151, 158], [125, 29, 
#    158], [143, 158, 151], [151, 158, 165], [122, 145, 143], [143, 145,
#     162], [96, 1, 112], [96, 112, 164], [112, 1, 164], [124, 152, 
#    141], [124, 141, 167], [141, 152, 167], [171, 130, 172], [130, 145,
#     172], [145, 171, 172], [131, 14, 151], [137, 154, 138], [154, 137,
#     166], [138, 154, 166], [65, 57, 66], [57, 65, 156], [148, 123, 
#    165], [143, 148, 165], [52, 53, 41], [52, 41, 159], [146, 97, 
#    155], [97, 56, 155], [56, 146, 155], [140, 147, 33], [147, 140, 
#    156], [33, 147, 156], [165, 150, 168], [150, 122, 168], [122, 165, 
#    168], [80, 128, 39], [125, 144, 19], [144, 125, 164], [32, 47, 
#    57], [47, 32, 156], [32, 57, 156], [42, 151, 24], [151, 42, 
#    158], [42, 24, 158], [25, 138, 79], [138, 25, 153], [25, 79, 
#    153], [79, 138, 153], [92, 112, 19], [112, 92, 164], [146, 163, 
#    96], [146, 96, 164], [155, 140, 163], [140, 162, 163], [150, 132, 
#    164], [125, 150, 164], [119, 72, 121], [119, 121, 160], [121, 72, 
#    160], [68, 144, 108], [144, 68, 158], [68, 108, 158], [22, 125, 
#    109], [22, 109, 132], [16, 128, 80], [154, 148, 166], [148, 137, 
#    166], [146, 2, 172], [59, 146, 172], [37, 9, 172], [9, 161, 
#    172], [80, 153, 79], [79, 153, 154], [31, 52, 41], [128, 148, 
#    131], [148, 128, 157], [128, 131, 157], [135, 123, 159], [123, 81, 
#    159], [66, 17, 65], [65, 17, 149], [134, 62, 157], [122, 165, 
#    148], [122, 148, 168], [148, 165, 168], [120, 136, 69], [136, 120, 
#    138], [120, 69, 138], [46, 128, 44], [46, 44, 157], [44, 128, 
#    157], [103, 107, 27], [103, 27, 149], [27, 107, 149], [128, 148, 
#    154], [45, 44, 5], [44, 45, 157], [45, 5, 157], [27, 133, 
#    103], [133, 27, 149], [103, 133, 149], [170, 37, 36], [170, 36, 
#    35], [36, 37, 35], [21, 126, 118], [21, 118, 138], [118, 126, 
#    138], [111, 1, 98], [1, 111, 163], [2, 146, 130], [146, 2, 
#    155], [2, 130, 155], [68, 116, 24], [116, 68, 158], [68, 24, 
#    158], [24, 116, 158], [23, 115, 66], [115, 23, 127], [66, 115, 
#    127], [120, 69, 117], [120, 117, 138], [117, 69, 138], [94, 128, 
#    44], [94, 44, 154], [117, 69, 21], [117, 21, 138], [59, 60, 
#    172], [60, 146, 172], [129, 161, 145], [129, 145, 169], [145, 161, 
#    169], [27, 115, 86], [143, 144, 158], [6, 32, 57], [6, 57, 
#    156], [114, 20, 100], [100, 20, 135], [60, 91, 37], [60, 37, 
#    129], [37, 91, 129], [123, 83, 137], [83, 15, 137], [15, 123, 
#    137], [159, 135, 169], [135, 123, 169], [123, 159, 169], [145, 152,
#     126], [145, 126, 171], [145, 160, 169], [160, 161, 169], [144, 
#    143, 170], [129, 144, 170], [63, 45, 62], [45, 63, 157], [62, 45, 
#    157], [132, 163, 162], [163, 132, 164], [132, 162, 164], [117, 25, 
#    120], [25, 117, 138], [33, 140, 90], [33, 90, 147], [90, 140, 
#    147], [119, 26, 102], [92, 10, 96], [10, 92, 164], [92, 96, 
#    164], [96, 10, 164], [24, 116, 42], [14, 43, 42], [42, 43, 
#    151], [33, 90, 155], [90, 147, 155], [82, 51, 15], [82, 15, 
#    131], [141, 122, 168], [64, 14, 88], [14, 64, 134], [64, 88, 
#    134], [146, 129, 172], [129, 162, 172], [148, 131, 165], [87, 88, 
#    29], [88, 87, 134], [140, 132, 150], [132, 149, 150], [99, 48, 
#    18], [99, 18, 124], [93, 83, 15], [83, 93, 137], [93, 15, 
#    137], [144, 129, 164], [29, 116, 108], [29, 108, 158], [108, 116, 
#    158], [123, 131, 15], [120, 99, 113], [113, 99, 124], [33, 6, 
#    90], [90, 6, 140], [157, 128, 168], [128, 142, 168], [141, 127, 
#    167], [106, 111, 17], [111, 106, 149], [34, 74, 113], [34, 113, 
#    147], [42, 43, 41], [42, 41, 151], [56, 11, 97], [97, 11, 
#    155], [28, 138, 154], [60, 58, 59], [85, 12, 104], [12, 85, 
#    133], [104, 12, 133], [99, 25, 153], [68, 24, 61], [24, 68, 
#    144], [68, 61, 144], [61, 24, 144], [140, 156, 127], [156, 140, 
#    167], [65, 140, 6], [140, 65, 156], [65, 6, 156], [62, 5, 49], [5, 
#    62, 157], [49, 5, 157], [45, 5, 62], [133, 63, 142], [63, 86, 
#    142], [4, 72, 73], [72, 4, 160], [4, 73, 160], [73, 72, 160], [54, 
#    147, 55], [132, 149, 133], [126, 160, 145], [160, 126, 171], [108, 
#    109, 105], [109, 108, 125], [108, 105, 125], [105, 109, 125], [49, 
#    14, 64], [14, 49, 134], [40, 13, 86], [86, 13, 142], [140, 90, 
#    155], [90, 11, 155], [11, 140, 155], [57, 139, 23], [23, 139, 156],
#    [140, 11, 163], [141, 152, 122], [90, 6, 65], [21, 72, 119], [21, 
#    119, 126], [95, 79, 101], [22, 110, 106], [110, 22, 132], [108, 
#    125, 29], [79, 78, 25], [78, 79, 153], [25, 78, 153], [105, 125, 
#    22], [125, 105, 133], [82, 131, 123], [41, 24, 42], [7, 144, 
#    170], [87, 12, 64], [87, 64, 134], [85, 103, 27], [85, 27, 
#    133], [80, 78, 79], [144, 24, 158], [63, 13, 45], [45, 13, 
#    157], [129, 162, 145], [129, 145, 172], [145, 162, 172], [118, 21, 
#    119], [133, 134, 168], [128, 131, 44], [85, 27, 86], [19, 125, 
#    108], [19, 108, 144], [100, 52, 81], [38, 39, 40], [155, 11, 
#    163], [63, 12, 85], [2, 130, 54], [161, 145, 172], [161, 171, 
#    172], [91, 7, 37], [123, 135, 137], [108, 116, 68], [139, 23, 
#    142], [136, 71, 171], [71, 70, 171], [66, 115, 107], [115, 66, 
#    149], [107, 115, 149], [159, 24, 170], [24, 53, 170], [156, 147, 
#    167], [150, 140, 163], [140, 132, 163], [132, 150, 163], [65, 17, 
#    89], [17, 65, 140], [72, 71, 73], [71, 72, 171], [72, 73, 
#    171], [45, 46, 44], [46, 45, 157], [113, 124, 34], [34, 124, 
#    147], [101, 25, 117], [25, 101, 138], [101, 117, 138], [4, 73, 
#    77], [77, 73, 160], [152, 145, 166], [145, 122, 166], [122, 152, 
#    166], [150, 125, 162], [122, 150, 162], [124, 141, 139], [139, 141,
#     167], [65, 6, 57], [65, 149, 140], [140, 149, 156], [139, 141, 
#    127], [50, 51, 49], [117, 21, 118], [117, 118, 138], [44, 46, 
#    16], [16, 46, 128], [141, 139, 153], [150, 162, 163], [70, 69, 
#    3], [3, 69, 136], [33, 90, 55], [55, 90, 155], [25, 78, 99], [67, 
#    7, 91], [7, 67, 144], [138, 153, 154], [123, 135, 126], [123, 126, 
#    137], [94, 44, 16], [14, 134, 131], [131, 134, 151], [100, 26, 
#    121], [19, 108, 68], [161, 114, 169], [20, 161, 169], [23, 127, 
#    142], [34, 124, 18], [148, 123, 166], [123, 137, 166], [3, 69, 
#    120], [3, 120, 136], [2, 58, 84], [84, 58, 172], [141, 152, 
#    166], [23, 139, 127], [44, 50, 5], [50, 44, 131], [18, 34, 
#    113], [18, 113, 124], [123, 143, 159], [143, 151, 159], [105, 109, 
#    22], [64, 88, 87], [86, 13, 63], [93, 28, 102], [93, 102, 
#    137], [102, 28, 137], [118, 101, 117], [132, 111, 163], [1, 132, 
#    163], [1, 132, 164], [146, 97, 163], [97, 155, 163], [36, 77, 
#    9], [60, 129, 172], [102, 83, 93], [44, 94, 131], [57, 47, 
#    23], [23, 47, 139], [133, 125, 134], [135, 126, 169], [126, 123, 
#    169], [19, 109, 108], [113, 99, 18], [23, 47, 38], [18, 47, 
#    32], [94, 50, 44], [109, 110, 22], [110, 109, 132], [126, 145, 
#    166], [24, 53, 61], [24, 61, 170], [61, 53, 170], [141, 128, 
#    153], [143, 122, 165], [84, 171, 130], [171, 84, 172], [52, 169, 
#    159], [143, 158, 159], [84, 54, 2], [54, 84, 130], [123, 126, 
#    166], [39, 46, 13], [13, 46, 142], [55, 54, 8], [130, 162, 
#    152], [162, 130, 167], [16, 46, 80], [80, 46, 128], [68, 61, 
#    67], [67, 61, 144], [80, 46, 39], [91, 10, 92], [121, 72, 4], [150,
#     162, 132], [127, 139, 142], [131, 134, 165], [134, 151, 165], [84,
#     75, 54], [75, 84, 130], [75, 74, 8], [94, 93, 15], [76, 161, 
#    172], [96, 112, 92], [29, 108, 105], [101, 79, 25], [107, 115, 
#    27], [102, 28, 118], [120, 113, 3], [90, 11, 55], [13, 46, 
#    45], [46, 13, 157], [84, 76, 0], [76, 84, 171], [84, 0, 171], [145,
#     126, 169], [126, 160, 169], [129, 145, 143], [143, 145, 169], [0, 
#    75, 84], [75, 0, 171], [84, 75, 171], [61, 7, 67], [7, 61, 
#    170], [61, 67, 170], [67, 7, 170], [145, 130, 162], [0, 70, 
#    75], [70, 0, 171], [160, 73, 171], [72, 160, 171], [71, 70, 
#    0], [126, 71, 171], [67, 144, 170], [35, 53, 20], [53, 35, 
#    170], [35, 20, 170], [84, 58, 76], [84, 76, 172], [161, 171, 
#    76], [76, 171, 172], [37, 9, 60], [37, 60, 172], [161, 37, 
#    170], [159, 169, 20], [20, 169, 170], [144, 61, 170], [24, 144, 
#    170], [97, 11, 98], [11, 97, 163], [154, 128, 166], [153, 138, 
#    166], [100, 20, 169], [128, 153, 166], [162, 150, 164], [109, 112, 
#    110], [109, 110, 164], [110, 112, 164], [132, 110, 164], [112, 1, 
#    110], [110, 1, 164], [61, 53, 35], [61, 35, 170], [61, 35, 
#    7], [154, 153, 166], [130, 155, 167], [127, 133, 168], [150, 133, 
#    168], [133, 125, 168], [125, 134, 168], [150, 125, 168], [165, 125,
#     168], [135, 160, 169], [114, 160, 169], [166, 126, 169], [145, 
#    166, 169], [166, 123, 169], [36, 170, 161], [122, 145, 169], [20, 
#    52, 100], [52, 20, 169], [122, 166, 169], [166, 148, 169], [158, 
#    144, 170], [24, 158, 170], [159, 158, 170], [158, 143, 170], [20, 
#    161, 170], [20, 36, 35], [36, 20, 170], [77, 73, 76], [73, 77, 
#    171], [77, 76, 171], [160, 77, 171], [161, 77, 171], [126, 72, 
#    171]]]

# mesh=[ # Stanford Bunny
#     [[0.105704, 2.30539, 1.82425], [0.120921, 1.84633, 
#    0.555539], [0.153675, 2.09244, 1.33308], [0.437675, 
#    2.35937, -1.23039], [0.414794, 2.31309, -1.01005], [0.405535, 
#    2.17578, -1.06472], [0.424989, 0.312461, 1.6201], [0.381187, 
#    0.283766, 2.17608], [0.400539, 0.0810914, 2.13897], [0.230722, 
#    1.23784, -2.18923], [0.284197, 1.62871, -2.07487], [0.211192, 
#    1.23546, -1.74278], [0.185893, 2.63155, 2.58176], [0.208684, 
#    1.77659, 2.70496], [0.206653, 1.98596, 0.422404], [0.269136, 
#    2.11683, 0.242097], [0.426149, 1.52322, -2.58245], [0.456931, 
#    1.42381, -2.58305], [0.399519, 1.47508, -2.86118], [0.318097, 
#    2.37142, 0.192443], [0.367335, 2.1709, -0.239952], [0.376189, 
#    2.45847, -0.18302], [0.478564, 0.683647, 2.15057], [0.407256, 
#    0.752928, 1.92311], [0.394819, 0.877288, 2.20672], [0.332355, 
#    2.5907, 0.190642], [0.237071, 2.41414, 0.650342], [0.357551, 
#    2.31967, -2.2906], [0.370804, 2.56625, -2.43786], [0.397145, 
#    2.33444, -2.21767], [0.281853, 2.79513, 1.08884], [0.20348, 
#    2.43421, 1.75564], [0.396806, 2.42654, -2.71603], [0.438667, 
#    2.47902, -2.57349], [0.317479, 2.64237, -3.06164], [0.284534, 
#    2.91242, 1.58963], [0.352492, 2.71307, 2.66261], [0.255928, 
#    0.84489, 3.05119], [0.236343, 0.724874, -3.11633], [0.175547, 
#    0.985764, 3.00551], [0.410272, 1.97362, -0.332843], [0.456605, 
#    2.03086, -0.545156], [0.445921, 2.086, -0.343478], [0.479675, 
#    0.565629, 2.01604], [0.291941, 0.838742, 2.75283], [0.311065, 
#    0.681563, 2.9075], [0.415309, 1.34884, -2.88143], [0.348102, 
#    1.40766, -3.11657], [0.299829, 0.612417, -2.64425], [0.30452, 
#    0.252261, -2.62107], [0.328435, 0.619814, -2.73059], [0.465114, 
#    2.36587, -1.83528], [0.405615, 2.31548, -1.58451], [0.385318, 
#    2.31799, -1.92983], [0.293946, 0.317845, 1.81197], [0.285347, 
#    0.31805, 1.22453], [0.203164, 1.24352, 0.147089], [0.25463, 
#    1.65651, 0.0451499], [0.184372, 1.60223, 0.20449], [0.385956, 
#    1.83927, -0.55709], [0.43238, 2.22467, -0.85317], [0.399602, 
#    2.01056, -0.580296], [0.410012, 0.290556, 1.19499], [0.392386, 
#    0.423304, 1.42583], [0.344665, 1.65848, -1.08006], [0.365572, 
#    1.63112, -0.701786], [0.333336, 1.45445, -0.872971], [0.3167, 
#    1.56075, -0.224587], [0.375609, 2.0112, -0.361161], [0.391025, 
#    1.71848, -2.82744], [0.39505, 1.81066, -2.62464], [0.37537, 
#    1.56126, -2.65237], [0.226777, 0.88216, -0.838968], [0.263824, 
#    1.16692, -0.413739], [0.185332, 0.845074, -0.326424], [0.363605, 
#    1.93266, -3.00373], [0.384123, 2.1673, -2.6117], [0.393604, 
#    2.00254, -2.54144], [0.235646, 0.644815, -2.76993], [0.177983, 
#    0.846586, -2.49106], [0.33841, 0.948836, 3.05188], [0.34531, 
#    0.930592, 2.33723], [0.352863, 1.57289, -2.94115], [0.264962, 
#    1.46557, 3.05441], [0.29343, 1.80578, 2.97907], [0.293728, 
#    0.982465, 3.00944], [0.487409, 0.64717, 2.37218], [0.349259, 
#    0.775202, -3.01043], [0.355208, 0.46026, -3.0143], [0.389333, 
#    0.79172, -2.72818], [0.30935, 0.619426, 3.1195], [0.446676, 
#    1.05058, -2.8903], [0.436156, 0.998481, -2.6491], [0.457262, 
#    1.2175, -2.58554], [0.40064, 1.14768, -2.96536], [0.309218, 
#    1.87468, -0.0210518], [0.36358, 0.860257, -2.37677], [0.417314, 
#    1.07409, -2.40455], [0.34919, 2.20794, -2.98249], [0.342857, 
#    2.1246, -1.95827], [0.382142, 2.70135, -3.0347], [0.381957, 
#    2.69908, 0.221436], [0.384605, 2.68376, -0.341094], [0.359845, 
#    2.85775, 2.30458], [0.273211, 1.10939, -1.10029], [0.290444, 
#    1.33507, -1.30714], [0.487409, 2.3572, -2.46952], [0.461701, 
#    0.737489, 2.53737], [0.0701211, 1.0596, 1.50047], [0.294782, 
#    2.4748, -3.00369], [0.343243, 1.5575, -2.41811], [0.363917, 
#    1.7645, -2.29318], [0.487409, 2.35914, -0.530591], [0.485199, 
#    2.3626, -0.762044], [0.423315, 2.4618, -2.97215], [0.323636, 
#    1.35563, -0.658636], [0.391555, 2.01825, -1.35747], [0.384187, 
#    1.89106, -0.937027], [0.366622, 1.8155, -1.2261], [0.346582, 
#    1.83213, -1.66109], [0.394543, 2.08144, -1.5882], [0.346245, 
#    1.74233, -1.4171], [0.110029, 0.466187, -1.97828], [0.371446, 
#    0.893768, 3.12394], [0.470635, 2.33711, -2.2563], [0.392889, 
#    0.782349, 2.73131], [0.447611, 1.31434, -2.42205], [0.358457, 
#    0.70623, 1.9581], [0.128176, 1.13236, 2.65609], [0.106177, 0.93017,
#     0.313408], [0.407195, 0.550872, 1.93326], [0.312054, 
#    0.95913, -2.39229], [0.398818, 1.42739, -2.30678], [0.326855, 
#    1.34743, -2.30585], [0.447955, 2.45188, -0.336633], [0.28658, 
#    1.73682, -1.78258], [0.370874, 1.93219, -2.31203], [0.213418, 
#    2.37795, 1.11946], [0.414167, 2.16048, -0.224496], [0.378092, 
#    0.436386, 1.65833], [0.456172, 2.42992, -1.22482], [0.26815, 
#    2.18947, 2.8538], [0.448679, 2.44954, -2.06329], [0.352605, 
#    2.51522, -2.62102], [0.388583, 0.781087, 2.39801], [0.389718, 
#    0.570554, 2.36405], [0.409259, 0.674161, 2.78429], [0.289272, 
#    0.189588, 1.10566]], [[0, 1], [1, 2], [2, 0], [3, 4], [4, 5], [5, 
#    3], [6, 7], [7, 8], [8, 6], [9, 10], [10, 11], [11, 9], [0, 
#    12], [12, 13], [13, 0], [14, 15], [15, 2], [2, 14], [16, 17], [17, 
#    18], [18, 16], [19, 20], [20, 21], [21, 19], [22, 23], [23, 
#    24], [24, 22], [25, 26], [26, 19], [19, 25], [27, 28], [28, 
#    29], [29, 27], [26, 30], [30, 31], [31, 26], [32, 33], [33, 
#    28], [28, 32], [34, 35], [35, 36], [36, 34], [37, 38], [38, 
#    39], [39, 37], [40, 41], [41, 42], [42, 40], [43, 23], [22, 
#    43], [37, 44], [44, 45], [45, 37], [46, 47], [47, 18], [18, 
#    46], [48, 49], [49, 50], [50, 48], [51, 52], [52, 53], [53, 
#    51], [54, 55], [55, 38], [38, 54], [56, 57], [57, 58], [58, 
#    56], [59, 60], [60, 61], [61, 59], [62, 55], [55, 63], [63, 
#    62], [61, 41], [40, 61], [64, 65], [65, 66], [66, 64], [67, 
#    59], [59, 68], [68, 67], [69, 70], [70, 71], [71, 69], [72, 
#    73], [73, 74], [74, 72], [75, 76], [76, 77], [77, 75], [56, 
#    67], [67, 57], [78, 79], [79, 38], [38, 78], [80, 24], [24, 
#    81], [81, 80], [82, 47], [47, 83], [83, 82], [13, 84], [84, 
#    83], [83, 13], [37, 85], [85, 44], [86, 43], [22, 86], [87, 
#    50], [50, 88], [88, 87], [89, 50], [87, 89], [45, 87], [87, 
#    90], [90, 45], [91, 92], [92, 89], [89, 91], [46, 93], [93, 
#    94], [94, 46], [68, 95], [95, 67], [96, 92], [92, 97], [97, 
#    96], [21, 25], [75, 84], [84, 98], [98, 75], [39, 13], [83, 
#    39], [99, 27], [27, 53], [53, 99], [100, 34], [36, 100], [101, 
#    102], [102, 103], [103, 101], [82, 75], [75, 69], [69, 82], [73, 
#    56], [56, 74], [92, 93], [93, 97], [104, 72], [72, 11], [11, 
#    104], [90, 37], [105, 66], [66, 104], [104, 105], [102, 106], [106,
#     103], [22, 107], [107, 86], [108, 1], [0, 108], [12, 35], [35, 
#    109], [109, 12], [110, 70], [70, 111], [111, 110], [90, 54], [38, 
#    90], [112, 41], [41, 113], [113, 112], [73, 67], [57, 14], [14, 
#    58], [114, 100], [100, 33], [33, 114], [103, 36], [35, 103], [101, 
#    25], [25, 102], [11, 105], [73, 115], [115, 67], [116, 117], [117, 
#    118], [118, 116], [119, 120], [120, 121], [121, 119], [2, 31], [31,
#     0], [82, 84], [35, 31], [30, 35], [122, 72], [74, 122], [71, 
#    82], [12, 31], [6, 62], [63, 6], [103, 100], [123, 94], [94, 
#    91], [91, 123], [124, 29], [29, 106], [106, 124], [125, 80], [80, 
#    123], [123, 125], [17, 93], [93, 18], [110, 10], [9, 110], [50, 
#    8], [8, 88], [93, 126], [126, 97], [1, 14], [39, 85], [32, 
#    114], [44, 127], [127, 45], [39, 128], [128, 13], [106, 28], [33, 
#    106], [129, 122], [74, 129], [127, 130], [130, 45], [131, 
#    132], [132, 133], [133, 131], [78, 9], [9, 79], [80, 94], [131, 
#    9], [9, 48], [48, 131], [120, 3], [3, 116], [116, 120], [82, 
#    18], [95, 57], [113, 106], [106, 134], [134, 113], [102, 21], [21, 
#    134], [134, 102], [65, 117], [117, 59], [59, 65], [111, 10], [13, 
#    108], [11, 135], [135, 105], [136, 27], [99, 136], [7, 54], [90, 
#    7], [137, 31], [2, 137], [23, 81], [43, 130], [130, 23], [91, 
#    87], [87, 123], [40, 138], [138, 20], [20, 40], [88, 7], [90, 
#    88], [66, 121], [121, 64], [17, 126], [5, 60], [60, 117], [117, 
#    5], [133, 9], [105, 121], [54, 139], [139, 55], [108, 122], [129, 
#    108], [135, 119], [119, 105], [33, 103], [80, 47], [47, 94], [136, 
#    111], [111, 77], [77, 136], [78, 48], [40, 68], [68, 61], [42, 
#    138], [135, 99], [99, 119], [108, 39], [39, 122], [140, 106], [113,
#     140], [141, 12], [109, 141], [135, 10], [10, 99], [114, 34], [61, 
#    113], [137, 26], [8, 62], [85, 83], [83, 80], [80, 85], [16, 
#    132], [132, 126], [126, 16], [63, 139], [139, 6], [99, 120], [131, 
#    97], [97, 132], [68, 20], [20, 95], [49, 8], [101, 35], [35, 
#    25], [142, 53], [53, 29], [29, 142], [112, 42], [27, 143], [143, 
#    28], [122, 11], [51, 142], [142, 140], [140, 51], [93, 91], [22, 
#    144], [144, 107], [108, 58], [58, 1], [145, 43], [86, 145], [140, 
#    3], [3, 52], [52, 140], [32, 143], [143, 114], [131, 96], [15, 
#    19], [26, 15], [121, 116], [118, 121], [58, 129], [129, 56], [141, 
#    98], [84, 141], [48, 96], [144, 125], [125, 107], [115, 66], [65, 
#    115], [99, 111], [109, 34], [34, 143], [143, 109], [4, 140], [113, 
#    4], [4, 60], [39, 79], [79, 122], [115, 72], [104, 115], [124, 
#    142], [57, 15], [69, 77], [77, 70], [133, 110], [110, 71], [13, 
#    141], [127, 23], [20, 15], [15, 95], [81, 85], [98, 76], [145, 
#    130], [48, 89], [89, 96], [81, 44], [144, 24], [80, 144], [65, 
#    67], [30, 25], [132, 110], [109, 98], [49, 62], [146, 125], [123, 
#    146], [138, 134], [134, 20], [76, 27], [27, 77], [60, 113], [78, 
#    49], [146, 107], [55, 78], [134, 112], [71, 18], [106, 142], [81, 
#    127], [42, 134], [109, 76], [87, 146], [79, 11], [52, 120], [120, 
#    53], [2, 26], [7, 139], [118, 64], [116, 5], [78, 147], [147, 
#    49], [45, 145], [145, 87], [147, 62], [109, 27], [146, 86], [110, 
#    16], [16, 71], [64, 117], [128, 108], [145, 146], [55, 147]], [[0, 
#    1, 2], [3, 4, 5], [6, 7, 8], [9, 10, 11], [0, 12, 13], [14, 15, 
#    2], [16, 17, 18], [19, 20, 21], [22, 23, 24], [25, 26, 19], [27, 
#    28, 29], [26, 30, 31], [32, 33, 28], [34, 35, 36], [37, 38, 
#    39], [40, 41, 42], [43, 23, 22], [37, 44, 45], [46, 47, 18], [48, 
#    49, 50], [51, 52, 53], [54, 55, 38], [56, 57, 58], [59, 60, 
#    61], [62, 55, 63], [61, 41, 40], [64, 65, 66], [67, 59, 68], [69, 
#    70, 71], [72, 73, 74], [75, 76, 77], [56, 67, 57], [78, 79, 
#    38], [80, 24, 81], [82, 47, 83], [13, 84, 83], [44, 37, 85], [86, 
#    43, 22], [87, 50, 88], [89, 50, 87], [45, 87, 90], [91, 92, 
#    89], [46, 93, 94], [67, 68, 95], [96, 92, 97], [19, 21, 25], [75, 
#    84, 98], [39, 13, 83], [99, 27, 53], [100, 34, 36], [101, 102, 
#    103], [82, 75, 69], [74, 73, 56], [97, 92, 93], [104, 72, 11], [90,
#     37, 45], [105, 66, 104], [103, 102, 106], [22, 107, 86], [108, 1, 
#    0], [12, 35, 109], [110, 70, 111], [90, 54, 38], [112, 41, 
#    113], [67, 56, 73], [58, 57, 14], [114, 100, 33], [103, 36, 
#    35], [101, 25, 102], [105, 104, 11], [67, 73, 115], [116, 117, 
#    118], [119, 120, 121], [2, 31, 0], [82, 84, 75], [35, 31, 
#    30], [122, 72, 74], [69, 71, 82], [31, 35, 12], [6, 62, 63], [36, 
#    103, 100], [123, 94, 91], [124, 29, 106], [125, 80, 123], [17, 93, 
#    18], [110, 10, 9], [50, 8, 88], [93, 126, 97], [14, 2, 1], [85, 37,
#     39], [33, 32, 114], [45, 44, 127], [39, 128, 13], [106, 28, 
#    33], [129, 122, 74], [127, 130, 45], [131, 132, 133], [78, 9, 
#    79], [123, 80, 94], [131, 9, 48], [120, 3, 116], [47, 82, 18], [67,
#     95, 57], [113, 106, 134], [102, 21, 134], [65, 117, 59], [10, 110,
#     111], [13, 108, 0], [11, 135, 105], [136, 27, 99], [7, 54, 
#    90], [137, 31, 2], [23, 81, 24], [43, 130, 23], [123, 91, 87], [40,
#     138, 20], [88, 7, 90], [64, 66, 121], [93, 17, 126], [5, 60, 
#    117], [131, 133, 9], [66, 105, 121], [55, 54, 139], [108, 122, 
#    129], [105, 135, 119], [33, 103, 106], [80, 47, 94], [136, 111, 
#    77], [48, 9, 78], [61, 40, 68], [40, 42, 138], [135, 99, 
#    119], [122, 108, 39], [140, 106, 113], [141, 12, 109], [99, 135, 
#    10], [100, 114, 34], [113, 41, 61], [137, 26, 31], [7, 88, 8], [62,
#     6, 8], [85, 83, 80], [16, 132, 126], [6, 63, 139], [120, 119, 
#    99], [131, 97, 132], [88, 90, 87], [95, 68, 20], [49, 8, 50], [20, 
#    68, 40], [25, 101, 35], [142, 53, 29], [41, 112, 42], [27, 143, 
#    28], [72, 122, 11], [51, 142, 140], [102, 134, 106], [91, 94, 
#    93], [0, 31, 12], [107, 22, 144], [91, 89, 87], [10, 135, 
#    11], [108, 58, 1], [145, 43, 86], [140, 3, 52], [53, 27, 29], [114,
#     32, 143], [97, 131, 96], [15, 19, 26], [121, 116, 118], [105, 119,
#     121], [56, 58, 129], [141, 98, 84], [51, 140, 52], [131, 48, 
#    96], [107, 144, 125], [100, 103, 33], [115, 66, 65], [136, 99, 
#    111], [109, 34, 143], [4, 140, 113], [34, 109, 35], [5, 4, 
#    60], [39, 79, 122], [115, 72, 104], [29, 124, 142], [15, 14, 
#    57], [69, 77, 70], [110, 9, 133], [72, 115, 73], [85, 39, 83], [59,
#     61, 68], [71, 70, 110], [13, 141, 84], [130, 127, 23], [99, 10, 
#    111], [20, 15, 95], [81, 85, 80], [75, 98, 76], [69, 75, 77], [145,
#     130, 43], [48, 89, 96], [44, 85, 81], [20, 19, 15], [144, 24, 
#    80], [115, 65, 67], [28, 106, 29], [30, 25, 35], [66, 115, 
#    104], [110, 133, 132], [83, 84, 82], [98, 141, 109], [139, 63, 
#    55], [49, 62, 8], [146, 125, 123], [138, 134, 20], [77, 76, 
#    27], [53, 142, 51], [113, 61, 60], [48, 78, 49], [107, 125, 
#    146], [55, 78, 38], [112, 113, 134], [121, 120, 116], [71, 18, 
#    82], [124, 106, 142], [22, 24, 144], [81, 127, 44], [28, 143, 
#    32], [25, 21, 102], [138, 42, 134], [98, 109, 76], [59, 117, 
#    60], [146, 123, 87], [122, 79, 11], [53, 52, 120], [141, 13, 
#    12], [129, 58, 108], [74, 56, 129], [2, 26, 137], [54, 7, 
#    139], [114, 143, 34], [127, 81, 23], [120, 99, 53], [91, 93, 
#    92], [17, 16, 126], [64, 121, 118], [15, 57, 95], [144, 80, 
#    125], [117, 116, 5], [49, 78, 147], [87, 45, 145], [79, 9, 
#    11], [147, 62, 49], [20, 134, 21], [93, 46, 18], [109, 27, 
#    76], [65, 59, 67], [146, 86, 107], [45, 130, 145], [110, 16, 
#    71], [26, 25, 30], [120, 52, 3], [89, 92, 96], [77, 27, 136], [64, 
#    117, 65], [16, 18, 71], [64, 118, 117], [42, 112, 134], [80, 83, 
#    47], [15, 26, 2], [108, 13, 128], [50, 89, 48], [110, 132, 
#    16], [143, 27, 109], [128, 39, 108], [35, 101, 103], [90, 38, 
#    37], [94, 47, 46], [3, 140, 4], [70, 77, 111], [132, 97, 
#    126], [146, 87, 145], [142, 106, 140], [58, 14, 1], [3, 5, 
#    116], [146, 145, 86], [139, 7, 6], [4, 113, 60], [38, 79, 
#    39], [147, 78, 55], [62, 147, 55]]]

# Format mesh for use in the solver. Mainly about ordering the edge connection
# array to make it easier to calculate the jacobian in solver. Have the lower
# value vertex index on the left of the tuple.
for a in mesh[1]:
    a.sort()
mesh[1].sort()

# Extract mesh information for indexing moving forward
vert_num=len(mesh[0])
sp_num=len(mesh[1])

# List of connecting vertices for each vertex. This is used in the velocity
# update constraints in the solver.
# (index of stoke vertex in mesh[0], index of spring for stoke in sparr)
conn_list=[]
for b in range(vert_num):
    conn_list.append([])
for c in range(vert_num):
    for d in mesh[1]:
        if c in d:
            if d.index(c)==0:
                conn_list[c].append([d[1],mesh[1].index(d)])
            else:
                conn_list[c].append([d[0],mesh[1].index(d)])

# Generate velocity and mass array
velocities=[]
masses=[]
for e in mesh[0]:
    velocities.append(initial_con(e,1.,.0).tolist())
    masses.append(1.)

# Generate parameter array (we will implicitly take all the vertices to have
# mass of 1 so not included in this array. Can add later if needed). The rest
# length of the springs for the edges are calculated from the mesh vertices
# separation values.
# (spring constant k (all set to 1 here), rest length l_eq)
sparr=[]
for f in mesh[1]:
    sparr.append([
        1.,
        h3dist(convertpos_rot2hyph3(mesh[0][f[0]]),convertpos_rot2hyph3(mesh[0][f[1]]))
        ])

# Intialize the time stepping for the integrator.
delT=.01
maxT=10+delT
nump=maxT/delT
timearr=np.arange(0,maxT,delT)

# Containers for trajectory data
q = 0
gat = []
gbt = []
ggt = []
dist = [] # contains distance data for all spring connections - index in multiples of total springs)
energy_dat=[] 

### Add initial conditions to the containers
# Position and kinetic energy data
kin_energy=0.
for g in range(vert_num):
    gat.append(mesh[0][g][0])
    gbt.append(mesh[0][g][1])
    ggt.append(mesh[0][g][2])
    kin_energy+=.5*masses[g]*( velocities[g][0]**2. + sinh(mesh[0][g][0])**2.*velocities[g][1]**2. + sinh(mesh[0][g][0])**2.*sin(mesh[0][g][1])**2.*velocities[g][2]**2. )

# Distance between vertices and potential energy
pot_energy=0.
for h in range(sp_num):
    dist.append(sparr[h][1])
    pot_energy+=.5*sparr[h][0]*( sparr[h][1] - sparr[h][1] )**2.

# Energy of system
energy_dat.append(kin_energy+pot_energy)

# Copy of mesh (position of vertices will be changed with the integration)
mesh_copy=cp.deepcopy(mesh)

# Make container for the updating velocities
velocities_copy=cp.deepcopy(velocities)

# Numerical Integration step
step_data=[
	imph3sprot_mesh(mesh_copy, velocities_copy, delT, masses, sparr, energy_dat, conn_list)
	]

# Copy of mesh and velocity array (position of vertices and velocity values will be changed with the integration)
new_mesh=cp.deepcopy(mesh)
new_velocities=cp.deepcopy(velocities)

# Store data from first time step
a_dat=step_data[0][0:3*vert_num:3]
b_dat=step_data[0][1:3*vert_num:3]
g_dat=step_data[0][2:3*vert_num:3]
ad_dat=step_data[0][3*vert_num+0:2*3*vert_num:3]
bd_dat=step_data[0][3*vert_num+1:2*3*vert_num:3]
gd_dat=step_data[0][3*vert_num+2:2*3*vert_num:3]

# Position and velocity data
for i in range(vert_num):
    gat.append(a_dat[i])
    gbt.append(b_dat[i])
    ggt.append(g_dat[i])
    new_mesh[0][i]=[a_dat[i],b_dat[i],g_dat[i]]
    new_velocities[i]=[ad_dat[i],bd_dat[i],gd_dat[i]]

# Distance between vertices
for j in range(sp_num):
    dist.append(h3dist(convertpos_rot2hyph3(new_mesh[0][new_mesh[1][j][0]]),convertpos_rot2hyph3(new_mesh[0][new_mesh[1][j][1]])))

# Energy of system
energy_dat.append(step_data[0][-1])

q=q+1

# Iterate through each time step using data from the previous step in the trajectory
while(q < nump-1):

    step_data=array([
        imph3sprot_mesh(new_mesh, new_velocities, delT, masses, sparr, energy_dat[-1], conn_list)
        ])

    # Copy of mesh and velocity array (position of vertices and velocity values will be changed with the integration)
    new_mesh=cp.deepcopy(new_mesh)
    new_velocities=cp.deepcopy(new_velocities)

    # Store data from first time step
    a_dat=step_data[0][0:3*vert_num:3]
    b_dat=step_data[0][1:3*vert_num:3]
    g_dat=step_data[0][2:3*vert_num:3]
    ad_dat=step_data[0][3*vert_num+0:2*3*vert_num:3]
    bd_dat=step_data[0][3*vert_num+1:2*3*vert_num:3]
    gd_dat=step_data[0][3*vert_num+2:2*3*vert_num:3]

    # Position and velocity data
    for k in range(vert_num):
        gat.append(a_dat[k])
        gbt.append(b_dat[k])
        ggt.append(g_dat[k])
        new_mesh[0][k]=[a_dat[k],b_dat[k],g_dat[k]]
        new_velocities[k]=[ad_dat[k],bd_dat[k],gd_dat[k]]

    # Distance between vertices
    for l in range(sp_num):
        dist.append(h3dist(convertpos_rot2hyph3(new_mesh[0][new_mesh[1][l][0]]),convertpos_rot2hyph3(new_mesh[0][new_mesh[1][l][1]])))

    # Energy of system
    energy_dat.append(step_data[0][-1])

    q=q+1


# Transform into Poincare disk model for plotting
gut=[]
gvt=[]
grt=[]


for i in range(len(gat)):
    gut.append(sinh(gat[i])*sin(gbt[i])*cos(ggt[i])/(cosh(gat[i]) + 1.))
    gvt.append(sinh(gat[i])*sin(gbt[i])*sin(ggt[i])/(cosh(gat[i]) + 1.))
    grt.append(sinh(gat[i])*cos(gbt[i])/(cosh(gat[i]) + 1.))	

# Save the time series data
# np.savetxt("dist12_data.csv",dist12) 
# np.savetxt("dist13_data.csv",dist13) 
# np.savetxt("dist23_data.csv",dist23)    	     		

#####################
#  PLOTTING SECTION #
#####################

# ------------------------------------------------------------------
### Uncomment to just plot trajectory in the Poincare disk model ###
# ------------------------------------------------------------------

# #Plot
# fig = plt.figure(figsize=(8,8))
# ax1 = fig.add_subplot(111, projection='3d')
# # ax1.set_aspect("equal")

# #draw sphere
# u, v = np.mgrid[0:np.pi+(np.pi)/15.:(np.pi)/15., 0:2.*np.pi+(2.*np.pi)/15.:(2.*np.pi)/15.]
# x = np.sin(u)*np.cos(v)
# y = np.sin(u)*np.sin(v)
# z = np.cos(u)
# ax1.plot_wireframe(x, y, z, color="b", alpha=.1)
# ax1.set_xlim3d(-1,1)
# ax1.set_xlabel('X')
# ax1.set_ylim3d(-1,1)
# ax1.set_ylabel('Y')
# ax1.set_zlim3d(-1,1)
# ax1.set_zlabel('Z')

# # Particle Plot data
# part_plot=[]
# for a in range(vert_num):
#     part_plot.append(hypercirch3(array([sinh(gat[-(vert_num-a)])*sin(gbt[-(vert_num-a)])*cos(ggt[-(vert_num-a)]),sinh(gat[-(vert_num-a)])*sin(gbt[-(vert_num-a)])*sin(ggt[-(vert_num-a)]),sinh(gat[-(vert_num-a)])*cos(gbt[-(vert_num-a)]),cosh(gat[-(vert_num-a)])]),.1))
#     ax1.plot_surface(part_plot[-1][0], part_plot[-1][1], part_plot[-1][2], color="b")

# #draw trajectory
# for b in range(vert_num):
#     ax1.plot3D(gut[b::vert_num],gvt[b::vert_num],grt[b::vert_num], label="particle []".format(b))
# ax1.legend(loc= 'lower left')

# plt.show()

# --------------------------------------------------------------------------------------
### Uncomment to just plot trajectory in the Poincare disk model with distance plots ###
# --------------------------------------------------------------------------------------

# Plot Trajectory with error
fig = plt.figure(figsize=(14,6))

ax1=fig.add_subplot(1,3,1,projection='3d')

#draw sphere
u, v = np.mgrid[0:np.pi+(np.pi)/15.:(np.pi)/15., 0:2.*np.pi+(2.*np.pi)/15.:(2.*np.pi)/15.]
x = np.sin(u)*np.cos(v)
y = np.sin(u)*np.sin(v)
z = np.cos(u)
ax1.plot_wireframe(x, y, z, color="b", alpha=.1)
ax1.set_xlim3d(-1,1)
ax1.set_xlabel('X')
ax1.set_ylim3d(-1,1)
ax1.set_ylabel('Y')
ax1.set_zlim3d(-1,1)
ax1.set_zlabel('Z')

# Particle Plot data
part_plot=[]
for a in range(vert_num):
    part_plot.append(hypercirch3(array([sinh(gat[-(vert_num-a)])*sin(gbt[-(vert_num-a)])*cos(ggt[-(vert_num-a)]),sinh(gat[-(vert_num-a)])*sin(gbt[-(vert_num-a)])*sin(ggt[-(vert_num-a)]),sinh(gat[-(vert_num-a)])*cos(gbt[-(vert_num-a)]),cosh(gat[-(vert_num-a)])]),.1))
    ax1.plot_surface(part_plot[-1][0], part_plot[-1][1], part_plot[-1][2], color="b")

#draw trajectory
for b in range(vert_num):
    ax1.plot3D(gut[b::vert_num],gvt[b::vert_num],grt[b::vert_num], label="particle []".format(b))
ax1.legend(loc= 'lower left')

# ax1.plot_surface(part1x, part1y, part1z, color="b")
# ax1.plot_surface(part2x, part2y, part2z, color="r")
# ax1.plot_surface(part3x, part3y, part3z, color="k")

# Displacement Plot
# ax2=fig.add_subplot(1,3,2)

# ax2.plot(timearr,(dist12-spring_arr[0][1]),label="Spring 12 Displacement")
# ax2.plot(timearr,(dist13-spring_arr[1][1]),label="Spring 13 Displacement")
# ax2.plot(timearr,(dist23-spring_arr[2][1]),label="Spring 23 Displacement")
# #ax2.axhline(y=spring[3]+sqrt(2.*1./spring[2]*.5*.5), color='b', linestyle='-')
# #ax2.axhline(y=((dist.max()-spring[3])+(dist.min()-spring[3]))/2., color='r', linestyle='-')
# #ax2.set_yscale("log",basey=10)	
# #ax2.set_ylabel('displacement (m)')
# ax2.set_xlabel('time (s)')
# ax2.legend(loc='lower right')

# Distance Plot
ax2=fig.add_subplot(1,3,2)

for c in range(sp_num):
    ax2.plot(timearr,dist[c::sp_num],label="Spring [] Distance".format(c))

# ax2.plot(timearr,dist[0::3],label="Spring 12 Distance")
# ax2.plot(timearr,dist[1::3],label="Spring 13 Distance")
# ax2.plot(timearr,dist[2::3],label="Spring 23 Distance")
#ax2.axhline(y=spring[3]+sqrt(2.*1./spring[2]*.5*.5), color='b', linestyle='-')
#ax2.axhline(y=((dist.max()-spring[3])+(dist.min()-spring[3]))/2., color='r', linestyle='-')
#ax2.set_yscale("log",basey=10)	
#ax2.set_ylabel('displacement (m)')
ax2.set_xlabel('time (s)')
ax2.legend(loc='lower right')

# Energy Plot
ax3=fig.add_subplot(1,3,3)

ax3.plot(timearr,energy_dat,label="Energy")
# ax3.set_yscale("log",basey=10)
ax3.set_xlabel('time (s)')	
ax3.legend(loc='lower right')

# Force Plot
# ax3=fig.add_subplot(1,3,3)

# ax3.plot(timearr,(dist12-spring_arr[0][1])*spring_arr[0][0],label="Spring 12 Force")
# ax3.plot(timearr,(dist13-spring_arr[1][1])*spring_arr[1][0],label="Spring 13 Force")
# ax3.plot(timearr,(dist23-spring_arr[2][1])*spring_arr[2][0],label="Spring 23 Force")
# # ax3.set_yscale("log",basey=10)
# ax3.set_xlabel('time (s)')	
# ax3.legend(loc='lower right')	

fig.tight_layout()	

plt.show()

# ------------------------------------------------------------------
### Uncomment to just generate gif of trajectory of the particle ###
# ------------------------------------------------------------------

# # Generate gif
# # create empty lists for the x and y data
# x1 = []
# y1 = []
# z1 = []
# x2 = []
# y2 = []
# z2 = []
# x3 = []
# y3 = []
# z3 = []

# # First set up the figure, the axis, and the plot element we want to animate
# fig = plt.figure(figsize=(8,8))
# ax1 = fig.add_subplot(111, projection='3d')
# # ax1.set_aspect("equal")

# #draw sphere
# u, v = np.mgrid[0:np.pi+(np.pi)/15.:(np.pi)/15., 0:2.*np.pi+(2.*np.pi)/15.:(2.*np.pi)/15.]
# x = np.sin(u)*np.cos(v)
# y = np.sin(u)*np.sin(v)
# z = np.cos(u)
# ax1.plot_wireframe(x, y, z, color="b", alpha=.1)
# ax1.set_xlim3d(-1,1)
# ax1.set_xlabel('X')
# ax1.set_ylim3d(-1,1)
# ax1.set_ylabel('Y')
# ax1.set_zlim3d(-1,1)
# ax1.set_zlabel('Z')

# # Particle Plot data
# part_plot=[]
# balls=[]
# for a in range(vert_num):
#     part_plot.append(hypercirch3(array([sinh(gat[a])*sin(gbt[a])*cos(ggt[a]),sinh(gat[a])*sin(gbt[a])*sin(ggt[a]),sinh(gat[a])*cos(gbt[a]),cosh(gat[a])]),.1))
#     balls.append([ax1.plot_surface(part_plot[-1][0], part_plot[-1][1], part_plot[-1][2], color="b")])

# # #draw trajectory
# # for b in range(vert_num):
# #     ax1.plot3D(gut[b::vert_num],gvt[b::vert_num],grt[b::vert_num], label="particle []".format(b))
# # ax1.legend(loc= 'lower left')

# # part1x,part1y,part1z=hypercirch3(array([sinh(gat[0::3][0])*sin(gbt[0::3][0])*cos(ggt[0::3][0]),sinh(gat[0::3][0])*sin(gbt[0::3][0])*sin(ggt[0::3][0]),sinh(gat[0::3][0])*cos(gbt[0::3][0]),cosh(gat[0::3][0])]),particles[0][7])
# # part2x,part2y,part2z=hypercirch3(array([sinh(gat[1::3][1])*sin(gbt[1::3][1])*cos(ggt[1::3][1]),sinh(gat[1::3][1])*sin(gbt[1::3][1])*sin(ggt[1::3][1]),sinh(gat[1::3][1])*cos(gbt[1::3][1]),cosh(gat[1::3][1])]),particles[1][7])
# # part3x,part3y,part3z=hypercirch3(array([sinh(gat[2::3][2])*sin(gbt[2::3][2])*cos(ggt[2::3][2]),sinh(gat[2::3][2])*sin(gbt[2::3][2])*sin(ggt[2::3][2]),sinh(gat[2::3][2])*cos(gbt[2::3][2]),cosh(gat[2::3][2])]),particles[2][7])
# # ball1=[ax1.plot_surface(part1x,part1y,part1z, color="b")]
# # ball2=[ax1.plot_surface(part2x,part2y,part2z, color="r")]
# # ball3=[ax1.plot_surface(part3x,part3y,part3z, color="k")]

# # animation function. This is called sequentially
# frames=50
# def animate(i):
#     for b in range(vert_num):
#         ax1.plot3D(gut[b::vert_num][:int(len(timearr)*i/frames)],gvt[b::vert_num][:int(len(timearr)*i/frames)],grt[b::vert_num][:int(len(timearr)*i/frames)], label="particle {}".format(b))
#     # ax1.plot3D(gut[0::3][:int(len(timearr)*i/frames)],gvt[0::3][:int(len(timearr)*i/frames)],grt[0::3][:int(len(timearr)*i/frames)])
#     # ax1.plot3D(gut[1::3][:int(len(timearr)*i/frames)],gvt[1::3][:int(len(timearr)*i/frames)],grt[1::3][:int(len(timearr)*i/frames)])
#     # ax1.plot3D(gut[2::3][:int(len(timearr)*i/frames)],gvt[2::3][:int(len(timearr)*i/frames)],grt[2::3][:int(len(timearr)*i/frames)])
#         part_plot.append(hypercirch3(array([sinh(gat[b::vert_num][int(len(timearr)*i/frames)])*sin(gbt[b::vert_num][int(len(timearr)*i/frames)])*cos(ggt[b::vert_num][int(len(timearr)*i/frames)]),sinh(gat[b::vert_num][int(len(timearr)*i/frames)])*sin(gbt[b::vert_num][int(len(timearr)*i/frames)])*sin(ggt[b::vert_num][int(len(timearr)*i/frames)]),sinh(gat[b::vert_num][int(len(timearr)*i/frames)])*cos(gbt[b::vert_num][int(len(timearr)*i/frames)]),cosh(gat[b::vert_num][int(len(timearr)*i/frames)])]),.1))
#         balls[b][0].remove()
#         balls[b][0]=ax1.plot_surface(part_plot[-1][0], part_plot[-1][1], part_plot[-1][2], color="b")
#     # part1x,part1y,part1z=hypercirch3(array([sinh(gat[0::3][int(len(timearr)*i/frames)])*sin(gbt[0::3][int(len(timearr)*i/frames)])*cos(ggt[0::3][int(len(timearr)*i/frames)]),sinh(gat[0::3][int(len(timearr)*i/frames)])*sin(gbt[0::3][int(len(timearr)*i/frames)])*sin(ggt[0::3][int(len(timearr)*i/frames)]),sinh(gat[0::3][int(len(timearr)*i/frames)])*cos(gbt[0::3][int(len(timearr)*i/frames)]),cosh(gat[0::3][int(len(timearr)*i/frames)])]),particles[0][7])
#     # part2x,part2y,part2z=hypercirch3(array([sinh(gat[1::3][int(len(timearr)*i/frames)])*sin(gbt[1::3][int(len(timearr)*i/frames)])*cos(ggt[1::3][int(len(timearr)*i/frames)]),sinh(gat[1::3][int(len(timearr)*i/frames)])*sin(gbt[1::3][int(len(timearr)*i/frames)])*sin(ggt[1::3][int(len(timearr)*i/frames)]),sinh(gat[1::3][int(len(timearr)*i/frames)])*cos(gbt[1::3][int(len(timearr)*i/frames)]),cosh(gat[1::3][int(len(timearr)*i/frames)])]),particles[1][7])
#     # part3x,part3y,part3z=hypercirch3(array([sinh(gat[2::3][int(len(timearr)*i/frames)])*sin(gbt[2::3][int(len(timearr)*i/frames)])*cos(ggt[2::3][int(len(timearr)*i/frames)]),sinh(gat[2::3][int(len(timearr)*i/frames)])*sin(gbt[2::3][int(len(timearr)*i/frames)])*sin(ggt[2::3][int(len(timearr)*i/frames)]),sinh(gat[2::3][int(len(timearr)*i/frames)])*cos(gbt[2::3][int(len(timearr)*i/frames)]),cosh(gat[2::3][int(len(timearr)*i/frames)])]),particles[2][7])
#     # ball1[0].remove()
#     # ball1[0]=ax1.plot_surface(part1x,part1y,part1z, color="b")
#     # ball2[0].remove()
#     # ball2[0]=ax1.plot_surface(part2x,part2y,part2z, color="r")
#     # ball3[0].remove()
#     # ball3[0]=ax1.plot_surface(part3x,part3y,part3z, color="k")

# # equivalent to rcParams['animation.html'] = 'html5'
# rc('animation', html='html5')

# # call the animator. blit=True means only re-draw the parts that 
# # have changed.
# anim = animation.FuncAnimation(fig, animate,frames=frames, interval=50)

# anim.save('./h3springmesh_test.gif', writer='imagemagick')

